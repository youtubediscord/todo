---
date:
tags:
link:
aliases:
img:
cssclasses:
---
# ⛔ Что делать если [[Zapret2]] (Запрет2) не работает 
## Какая стратегия лучше всего? / У меня сломался Zapret после ваших обновлений
### ❓ Что делать если я перепробовал ВСЕ стратегии?
Часто возникает вопрос: "Какая конфигурация для zapret точно работает?". Правильный ответ — никакая. Не существует универсального рецепта, который гарантированно будет работать у всех, всегда и везде. zapret — это не кнопка "сделать хорошо", а сложный инструмент, успех которого зависит от огромного количества переменных на стороне пользователя.

Если ваш привычный способ обхода блокировок перестал работать или его эффективность заметно снизилась, поймите следующее:

* **Сам "запрет" не "сломался" и не перестал действовать.** Механизмы блокировки остаются активными.
* **Стратегии обхода, заложенные в нашей программе, как правило, стабильны** и почти не меняются от обновления к обновлению.

**Наиболее вероятная причина – ваш интернет-провайдер обновил свои системы ТСПУ DPI (Deep Packet Inspection).** Именно эти системы анализируют ваш трафик. После обновления DPI ваша ранее работавшая стратегия обхода могла стать "видимой" для провайдера и перестать быть эффективной.

### Какая же стратегия наиболее рабочая?
Пользователи часто спрашивают: «Какая стратегия самая рабочая?» Ответ — никакая конкретная, потому что результат зависит от множества переменных, большинство из которых находятся вне контроля пользователя.

zapret — это инструмент обхода DPI (Deep Packet Inspection). Он работает локально, модифицируя исходящие пакеты так, чтобы система фильтрации не смогла корректно их проанализировать. Он не меняет ваш IP-адрес, не создаёт туннелей и не маршрутизирует трафик через внешние серверы.

### 1. Инфраструктура блокировок неоднородна
Разное оборудование ТСПУ в разных регионах. Технические средства противодействия угрозам разворачиваются неравномерно. В одном регионе может стоять устаревшее оборудование, которое обходится простейшей фрагментацией, а в другом — современное, способное на полную пересборку фрагментов и глубокий анализ TLS-хэндшейка.

«Региональная лотерея». То, что работает у пользователя в Москве, может быть наглухо заблокировано в Новосибирске или Владивостоке. Провайдеры на местах могут иметь разные версии прошивок ТСПУ, разные настройки агрессивности фильтрации и разные сроки обновления оборудования.

Разные магистральные провайдеры. Ваш региональный провайдер получает интернет от магистрального оператора. Фильтрация может происходить на любом из уровней — у вашего провайдера, у магистрального, или на обоих сразу. Стратегия, обходящая один уровень, может не пройти через другой.

### 2. Тип блокировки определяет эффективность
Блокировка по IP-адресу. Если провайдер блокирует по IP целиком, zapret бессилен — он модифицирует содержимое пакетов, но не меняет адрес назначения. Против блокировки по IP нужен VPN или прокси.

Блокировка по DPI (анализ содержимого). Именно для этого сценария и создан zapret. Он фрагментирует пакеты (ipfrag), разбивает TLS ClientHello (multisplit), отправляет поддельные пакеты (fake) и применяет другие техники, чтобы DPI не смог распознать протокол или домен.

«Троттлинг» (замедление). Вместо полной блокировки провайдер может снижать скорость для подозрительных паттернов трафика. zapret формально работает, но скорость становится непригодной для использования. Определить троттлинг сложнее, чем полную блокировку.

### 3. Конфликты с локальным окружением
Антивирус и сторонний файрвол. Одна из самых частых причин неработоспособности. Антивирусное ПО видит, что программа перехватывает и модифицирует сетевые пакеты, расценивает это как угрозу и блокирует zapret. Необходимо добавлять исключения.

Другие VPN-клиенты. Если одновременно запущен VPN, он создаёт собственные правила маршрутизации и может перенаправлять трафик мимо zapret, либо конфликтовать с ним на уровне сетевого стека.

Настройки DNS. Если в браузере или системе включён DNS-over-HTTPS (DoH) или DNS-over-TLS, DNS-запросы шифруются и уходят напрямую к внешнему резолверу. Это может как помогать (провайдер не видит DNS), так и мешать (zapret в режиме tpws может не знать реальный IP назначения).

Настройки DNS на роутере. Если роутер принудительно раздаёт провайдерские DNS-серверы, это может конфликтовать с настройками zapret и приводить к тому, что DNS-ответы подменяются ещё до того, как zapret сможет вмешаться.

### 4. Сложность современных веб-сайтов
Множество доменов. Современный сайт подгружает ресурсы с десятков доменов (CDN, аналитика, шрифты, API). Стратегия zapret может успешно обойти блокировку основного домена, но если критический ресурс загружается с другого домена, который тоже фильтруется — сайт будет работать некорректно или не загрузится вовсе.

### 5. Цепочка, в которой важно каждое звено
zapret — не изолированное приложение, а элемент цепочки:

```
Браузер → ОС → Антивирус → zapret → Роутер → Провайдер → Магистраль → Сервер назначения
```

Сбой или конфликт в любом из этих звеньев приводит к неработоспособности всей схемы. Именно поэтому одна и та же стратегия даёт разный результат у разных пользователей — даже если они находятся у одного провайдера в одном городе.

### Вывод
Единственный надёжный способ найти рабочую стратегию — анализ нескольких типичных стратегий из готовых [[preset|пресетов]] и просмотр какие [[Zapret2 - lua-desync|техники дурения]] наиболее активные.

## Что ещё может помочь:

1. Проверить, что версия программы действительно [последняя](https://t.me/zapretnetdiscordyoutube). В Вашей версии с немалой вероятностью могла сломаться функция проверки обновлений - будет писать, что обновление не найдено, хотя по факту оно есть, просто сервер для них в очередной раз переехал (его ддосили и ломали) - поэтому проверьте версию и обновитесь вручную. 
2. Попробовать стратегию "Alt 2" (под номером один на классическом запуске).
3. Попробовать все стратегии не только на классическом запуске, но и на [прямом](https://github.com/youtubediscord/zapret/wiki/%D0%9A%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D0%B8-%D0%9F%D1%80%D1%8F%D0%BC%D0%BE%D0%B9-%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA) с разными [флагами](https://github.com/user-attachments/assets/5185b0f2-833d-42be-9ea8-25efd4d97195) и разными [аргументами запуска](https://github.com/user-attachments/assets/46109eb5-c912-442d-ad36-137151983825).
Также может помочь, выключить на прямом запуске **вообще все вкладки** (для этого в самом низу есть пустая стратегия), а потом **включить только** те вкладки, в названии которых стоит **имя** нужного сайта/приложения.
4. [Скачать тестовую (dev) версию](https://github.com/youtubediscord/zapret/releases) и сделать то же самое - в ней могут находиться новые стратегии и быть исправлены некоторые баги.
5. Пройтись [блокчеком](https://t.me/zapretblockcheck/4) (только для YouTube и Discord). Занимает обычно более часа, так как команд там огромное множество и он их по очереди проверяет.p
6. Попробовать [ByeByeDPI](https://t.me/byebyedpi_group). Он и для [Windows](https://t.me/byebyedpi_group/253020), и для [Android](https://t.me/byebyedpi_group/118880). Помимо стратегий в самом приложении (в автоподборе), в их группе можно найти [стратегии от других пользователей](https://t.me/byebyedpi_group/21941/). Например, [эта стратегия](https://t.me/byebyedpi_group/21941/480245) обходит блокировки почти всех сайтов.

## Обязательно к прочтению, если не работает Discord:
#### Нужно сначала полностью наладить работу сайта discord.com, а потом уже приложения.
#### Если ошибка "Подключение к RTC", то после каждой смены стратегии может потребоваться переподключаться в голосовой канал заново, а не ждать подключения, даже несмотря на то, что приложение само перезапускается. На сайте аналогично - нужно вручную переподключаться в голосовой канал.
#### Если приложение зависло на этапе проверки обновлений, нужно вручную обновить его с сайта.
#### Для звонков можно включить [сквозное шифрование](https://github.com/user-attachments/assets/8d5b6a37-7f77-414e-bf55-8ac4884715f7) в настройках дс. Это в исключительных случаях может помочь решить некоторые проблемы с ними.