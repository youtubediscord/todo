---
tags:
link:
aliases:
img:
height: 1000
---

## –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–±–º–∞–Ω–æ–∫ (fooling) –≤ zapret2

### üîπ **IP/IPv4 –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**

1. **`ip_ttl=N`** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TTL (Time To Live) –≤ IPv4 –∑–∞–≥–æ–ª–æ–≤–∫–µ
   - –ü—Ä–∏–º–µ—Ä: `ip_ttl=5`

2. **`ip_autottl=delta,min-max`** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ TTL
   - –§–æ—Ä–º–∞—Ç: `delta,min-max` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `-1,3-20`)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π TTL –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞–∫–µ—Ç–æ–≤

### üîπ **IPv6 –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**

3. **`ip6_ttl=N`** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Hop Limit –≤ IPv6 –∑–∞–≥–æ–ª–æ–≤–∫–µ (–∞–Ω–∞–ª–æ–≥ TTL)
   - –ü—Ä–∏–º–µ—Ä: `ip6_ttl=3`

4. **`ip6_autottl=delta,min-max`** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Hop Limit –¥–ª—è IPv6
   - –§–æ—Ä–º–∞—Ç: `delta,min-max`

### üîπ **IPv6 Extension Headers (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏)**

5. **`ip6_hopbyhop[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å Hop-by-Hop –∑–∞–≥–æ–ª–æ–≤–æ–∫
   - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó8 –±–∞–π—Ç
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `\x00\x00\x00\x00\x00\x00`

6. **`ip6_hopbyhop2[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π Hop-by-Hop –∑–∞–≥–æ–ª–æ–≤–æ–∫
   - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó8 –±–∞–π—Ç

7. **`ip6_destopt[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å Destination Options –∑–∞–≥–æ–ª–æ–≤–æ–∫ (unfragmentable part)
   - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó8 –±–∞–π—Ç

8. **`ip6_destopt2[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π Destination Options –∑–∞–≥–æ–ª–æ–≤–æ–∫ (fragmentable part)
   - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó8 –±–∞–π—Ç

9. **`ip6_routing[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å Routing –∑–∞–≥–æ–ª–æ–≤–æ–∫
   - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó8 –±–∞–π—Ç

10. **`ip6_ah[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å Authentication Header (—É—Å–µ—á–µ–Ω–Ω—ã–π)
    - –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 6+N√ó4 –±–∞–π—Ç
    - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `\x00\x00` + 4 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç–∞

### üîπ **TCP –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**

11. **`tcp_seq=N`** - –¥–æ–±–∞–≤–∏—Ç—å N –∫ TCP sequence number
    - –ü—Ä–∏–º–µ—Ä: `tcp_seq=10000`
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è "badseq" –æ–±–º–∞–Ω–∫–∏

12. **`tcp_ack=N`** - –¥–æ–±–∞–≤–∏—Ç—å N –∫ TCP acknowledgment number
    - –ü—Ä–∏–º–µ—Ä: `tcp_ack=-66000`
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è "badack" –æ–±–º–∞–Ω–∫–∏ (–æ–±—ã—á–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

13. **`tcp_ts=N`** - –¥–æ–±–∞–≤–∏—Ç—å N –∫ TCP timestamp value
    - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç TCP –æ–ø—Ü–∏—é timestamp

14. **`tcp_md5[=hex]`** - –¥–æ–±–∞–≤–∏—Ç—å TCP MD5 –æ–ø—Ü–∏—é (RFC 2385)
    - –†–∞–∑–º–µ—Ä: 16 –±–∞–π—Ç
    - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    - –ü—Ä–∏–º–µ—Ä: `tcp_md5` –∏–ª–∏ `tcp_md5=0x00112233445566778899aabbccddeeff`

15. **`tcp_flags_set=<—Å–ø–∏—Å–æ–∫>`** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TCP —Ñ–ª–∞–≥–∏
    - –°–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: `FIN,SYN,RST,PSH,ACK,URG,ECE,CWR`
    - –ü—Ä–∏–º–µ—Ä: `tcp_flags_set=PSH,URG`

16. **`tcp_flags_unset=<—Å–ø–∏—Å–æ–∫>`** - —Å–Ω—è—Ç—å TCP —Ñ–ª–∞–≥–∏
    - –ü—Ä–∏–º–µ—Ä: `tcp_flags_unset=ACK` (–¥–ª—è "datanoack" –æ–±–º–∞–Ω–∫–∏)

17. **`tcp_ts_up`** - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å TCP timestamp –æ–ø—Ü–∏—é –≤ –Ω–∞—á–∞–ª–æ
    - –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    - Workaround –¥–ª—è Linux: –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã —Å badack –±–µ–∑ badseq

### üîπ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏**

18. **`badsum`** - —Å–¥–µ–ª–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Å—É–º–º—É L4 –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π
    - –ë–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    - –û—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ reconstruct options

19. **`fool=—Ñ—É–Ω–∫—Ü–∏—è`** - –≤—ã–∑–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ–±–º–∞–Ω–∫–∏
    - –§–æ—Ä–º–∞—Ç: `fool_func(dis, fooling_options)`
    - –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–±–º–∞–Ω–æ–∫

### üìã **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (–∏–∑ nfqws1)**

–í —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ (nfqws1) –±—ã–ª–∏ –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏:

- **`md5sig`** ‚Üí `tcp_md5`
- **`badseq`** ‚Üí `tcp_seq=-10000` (–¥–ª—è SYN) –∏–ª–∏ `tcp_ack=-66000` (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤)
- **`badack`** ‚Üí `tcp_ack=-66000`
- **`datanoack`** ‚Üí `tcp_flags_unset=ACK`

### üí° **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

```bash
# –ü—Ä–æ—Å—Ç–æ–π TTL
--lua-desync=fake:ip_ttl=5

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π TTL
--lua-desync=fake:ip_autottl=-1,3-20

# TCP MD5 signature (–æ–±–º–∞–Ω–∫–∞ –¥–ª—è DPI)
--lua-desync=fake:tcp_md5

# Badseq + badack (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –æ–±–º–∞–Ω–∫–∞)
--lua-desync=fakedsplit:tcp_seq=-10000:tcp_ack=-66000:tcp_ts_up

# IPv6 extension headers
--lua-desync=fake:ip6_hopbyhop:ip6_destopt

# –°–Ω—è—Ç—å ACK —Ñ–ª–∞–≥ (datanoack)
--lua-desync=fake:tcp_flags_unset=ACK

# –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±–º–∞–Ω–æ–∫
--lua-desync=fake:ip_ttl=1:tcp_md5:tcp_ack=-66000
```

–í—Å–µ —ç—Ç–∏ –æ–±–º–∞–Ω–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π `apply_fooling()` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `zapret-lib.lua` –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI —Å–∏—Å—Ç–µ–º –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ DPI, –Ω–æ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è —Ü–µ–ª–µ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.