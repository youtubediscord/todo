---
tags:
link:
aliases:
img:
---

## WinDivert —Ñ–∏–ª—å—Ç—Ä—ã (`--wf-*`) –≤ zapret2 –¥–ª—è Windows

**WinDivert** ‚Äî —ç—Ç–æ –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è Windows, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞. –í zapret2 –¥–ª—è Windows –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ **winws2** (–≤–º–µ—Å—Ç–æ nfqws2 –¥–ª—è Linux), –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å WinDivert.

---

## üì¶ **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã WinDivert —Ñ–∏–ª—å—Ç—Ä–æ–≤**

### 1. **`--wf-iface`** - –§–∏–ª—å—Ç—Ä –ø–æ —Å–µ—Ç–µ–≤–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-iface=<int>[.<int>]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `int` - –∏–Ω–¥–µ–∫—Å —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `int.int` - –∏–Ω–¥–µ–∫—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –ø–æ–¥–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-iface=1        # –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å 1
--wf-iface=2.0      # –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å 2, –ø–æ–¥–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å 0
```

---

### 2. **`--wf-l3`** - –§–∏–ª—å—Ç—Ä L3 –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-l3=ipv4|ipv6
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ipv4` - —Ç–æ–ª—å–∫–æ IPv4
- `ipv6` - —Ç–æ–ª—å–∫–æ IPv6
- –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-l3=ipv4
--wf-l3=ipv4,ipv6
```

---

### 3. **`--wf-tcp-in`** - TCP –≤—Ö–æ–¥—è—â–∏–µ –ø–æ—Ä—Ç—ã

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-tcp-in=[~]port1[-port2]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `port` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Ä—Ç
- `port1-port2` - –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç–æ–≤
- `~port` - –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ (–≤—Å–µ –∫—Ä–æ–º–µ)
- –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-tcp-in=80,443       # –≤—Ö–æ–¥—è—â–∏–µ –Ω–∞ –ø–æ—Ä—Ç—ã 80 –∏ 443
--wf-tcp-in=1000-2000    # –¥–∏–∞–ø–∞–∑–æ–Ω
--wf-tcp-in=~443         # –≤—Å–µ –∫—Ä–æ–º–µ 443
```

---

### 4. **`--wf-tcp-out`** - TCP –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–æ—Ä—Ç—ã

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-tcp-out=[~]port1[-port2]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `--wf-tcp-in`)

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-tcp-out=80,443      # –∏—Å—Ö–æ–¥—è—â–∏–µ –Ω–∞ –ø–æ—Ä—Ç—ã 80 –∏ 443
```

---

### 5. **`--wf-udp-in`** - UDP –≤—Ö–æ–¥—è—â–∏–µ –ø–æ—Ä—Ç—ã

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-udp-in=[~]port1[-port2]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ TCP)

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-udp-in=53,443       # DNS –∏ QUIC –≤—Ö–æ–¥—è—â–∏–µ
```

---

### 6. **`--wf-udp-out`** - UDP –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–æ—Ä—Ç—ã

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-udp-out=[~]port1[-port2]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ TCP)

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-udp-out=443         # QUIC –∏—Å—Ö–æ–¥—è—â–∏–µ
```

---

### 7. **`--wf-tcp-empty`** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö TCP –ø–∞–∫–µ—Ç–æ–≤

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-tcp-empty=[0|1]
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `0` - –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ TCP –ø–∞–∫–µ—Ç—ã –±–µ–∑ —Ñ–ª–∞–≥–æ–≤ SYN/RST/FIN (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `1` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ TCP –ø–∞–∫–µ—Ç—ã

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-tcp-empty=1         # –≤–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
```

---

### 8. **`--wf-raw-part`** - –ß–∞—Å—Ç–∏—á–Ω—ã–π raw —Ñ–∏–ª—å—Ç—Ä ‚≠ê

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-raw-part=<filter>|@<filename>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `filter` - —Å—Ç—Ä–æ–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ —è–∑—ã–∫–µ WinDivert
- `@filename` - –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏–∑ —Ñ–∞–π–ª–∞
- –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑** - –æ–Ω–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ OR

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞ (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ)
- –Ø–∑—ã–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ—Ö–æ–∂ –Ω–∞ tcpdump/Wireshark
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É payload
- –≠–∫–æ–Ω–æ–º–∏—Ç CPU, –Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—è –≤–µ—Å—å –ø–æ—Ç–æ–∫

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –ü—Ä—è–º–æ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
--wf-raw-part="outbound and udp.DstPort=443 and udp.PayloadLength>=256"

# –ò–∑ —Ñ–∞–π–ª–∞
--wf-raw-part=@windivert_part.discord_media.txt

# –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤
--wf-raw-part=@discord.txt --wf-raw-part=@stun.txt --wf-raw-part=@quic.txt
```

---

### 9. **`--wf-filter-lan`** - –§–∏–ª—å—Ç—Ä –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-filter-lan=0|1
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `0` - –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
- `1` - –∏—Å–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–ò—Å–∫–ª—é—á–∞–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã:**
- IPv4: 127.0.0.0/8, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16
- IPv6: ::1/128, fc00::/7, fe80::/10, ff00::/8

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-filter-lan=0        # –Ω–µ –∏—Å–∫–ª—é—á–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
```

---

### 10. **`--wf-raw`** - –ü–æ–ª–Ω—ã–π raw —Ñ–∏–ª—å—Ç—Ä

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-raw=<filter>|@<filename>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `filter` - –ø–æ–ª–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ WinDivert
- `@filename` - –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
- **–ó–ê–ú–ï–ù–Ø–ï–¢** –≤—Å–µ `--wf-tcp`, `--wf-udp`, `--wf-raw-part`

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-raw="!impostor and !loopback and outbound and tcp.DstPort=443"
--wf-raw=@full_filter.txt
```

---

### 11. **`--wf-save`** - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∏ –≤—ã–π—Ç–∏

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--wf-save=<filename>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `filename` - –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
--wf-tcp-out=80,443 --wf-save=generated_filter.txt
```

---

### üî§ –Ø–∑—ã–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤ WinDivert
–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:

–õ–æ–≥–∏—á–µ—Å–∫–∏–µ:
- and - –ò
- or - –ò–õ–ò
- not –∏–ª–∏ ! - –ù–ï

–°—Ä–∞–≤–Ω–µ–Ω–∏—è:
- == –∏–ª–∏ = - —Ä–∞–≤–Ω–æ
- != - –Ω–µ —Ä–∞–≤–Ω–æ
- <, >, <=, >= - —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- outbound - –∏—Å—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã
- inbound - –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ:
- impostor - –ø–∞–∫–µ—Ç—ã –æ—Ç –¥—Ä—É–≥–∏—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- loopback - loopback –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å


---

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è:

#### **IP (IPv4):**
```
ip                    # IPv4 –ø–∞–∫–µ—Ç
ip.SrcAddr            # IP –∏—Å—Ç–æ—á–Ω–∏–∫–∞
ip.DstAddr            # IP –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
ip.Length             # –î–ª–∏–Ω–∞ IP –ø–∞–∫–µ—Ç–∞
ip.TTL                # Time To Live
ip.Protocol           # –ü—Ä–æ—Ç–æ–∫–æ–ª (6=TCP, 17=UDP)
```

#### **IPv6:**
```
ipv6                  # IPv6 –ø–∞–∫–µ—Ç
ipv6.SrcAddr          # IPv6 –∏—Å—Ç–æ—á–Ω–∏–∫–∞
ipv6.DstAddr          # IPv6 –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
ipv6.Length           # –î–ª–∏–Ω–∞ –ø–∞–∫–µ—Ç–∞
ipv6.HopLimit         # Hop Limit
ipv6.NextHdr          # –°–ª–µ–¥—É—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
```

#### **TCP:**
```
tcp                   # TCP –ø–∞–∫–µ—Ç
tcp.SrcPort           # –ü–æ—Ä—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞
tcp.DstPort           # –ü–æ—Ä—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
tcp.Syn               # SYN —Ñ–ª–∞–≥
tcp.Rst               # RST —Ñ–ª–∞–≥
tcp.Fin               # FIN —Ñ–ª–∞–≥
tcp.Ack               # ACK —Ñ–ª–∞–≥
tcp.Psh               # PSH —Ñ–ª–∞–≥
tcp.PayloadLength     # –î–ª–∏–Ω–∞ payload
tcp.Payload[N]        # –ë–∞–π—Ç payload –ø–æ –∏–Ω–¥–µ–∫—Å—É N
tcp.Payload16[N]      # 16-bit –∑–Ω–∞—á–µ–Ω–∏–µ (little-endian)
tcp.Payload32[N]      # 32-bit –∑–Ω–∞—á–µ–Ω–∏–µ (little-endian)
```

#### **UDP:**
```
udp                   # UDP –ø–∞–∫–µ—Ç
udp.SrcPort           # –ü–æ—Ä—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞
udp.DstPort           # –ü–æ—Ä—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
udp.PayloadLength     # –î–ª–∏–Ω–∞ payload
udp.Payload[N]        # –ë–∞–π—Ç payload –ø–æ –∏–Ω–¥–µ–∫—Å—É N
udp.Payload16[N]      # 16-bit –∑–Ω–∞—á–µ–Ω–∏–µ (little-endian)
udp.Payload32[N]      # 32-bit –∑–Ω–∞—á–µ–Ω–∏–µ (little-endian)
```

#### **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```
ifIdx                 # –ò–Ω–¥–µ–∫—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
subIfIdx              # –ò–Ω–¥–µ–∫—Å –ø–æ–¥–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
```

---

## üìù **–ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤**

### –ü—Ä–∏–º–µ—Ä 1: QUIC Initial (IETF)
```
outbound and
udp.PayloadLength>=256 and
udp.Payload[0]>=0xC0 and udp.Payload[0]<0xD0 and
udp.Payload[1]=0 and udp.Payload16[1]=0 and udp.Payload[4]=1
```

### –ü—Ä–∏–º–µ—Ä 2: STUN
```
outbound and
udp.PayloadLength>=20 and
udp.Payload32[1]=0x2112A442 and udp.Payload[0]<0x40
```

### –ü—Ä–∏–º–µ—Ä 3: WireGuard
```
outbound and
udp.PayloadLength=148 and
udp.Payload[0]=0x01
```

### –ü—Ä–∏–º–µ—Ä 4: Discord Media
```
outbound and ip and
udp.DstPort>=50000 and udp.DstPort<=50099 and
udp.PayloadLength=74 and
udp.Payload32[0]=0x00010046 and
udp.Payload32[2]=0 and
udp.Payload32[3]=0
```

### –ü—Ä–∏–º–µ—Ä 5: TLS Client Hello
```
outbound and
tcp.PayloadLength>=5 and
tcp.Payload[0]=0x16 and
tcp.Payload[1]=0x03 and
tcp.Payload[2]>=0x01 and tcp.Payload[2]<=0x03
```

### –ü—Ä–∏–º–µ—Ä 6: HTTP Redirect (302/307)
```
tcp.PayloadLength>=12 and
tcp.Payload32[0]==0x48545450 and
tcp.Payload16[2]==0x2F31 and
tcp.Payload[6]==0x2E and
tcp.Payload16[4]==0x2033 and
tcp.Payload[10]==0x30 and
(tcp.Payload[11]==0x32 or tcp.Payload[11]==0x37)
```

---

## üí° **–ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç HTTP/HTTPS
```bash
winws2 ^
  --wf-tcp-out=80,443 ^
  --lua-init=@zapret-lib.lua --lua-init=@zapret-antidpi.lua ^
  --filter-tcp=80,443 --filter-l7=http,tls ^
  --lua-desync=fake:blob=fake_default_tls
```

### –ü—Ä–∏–º–µ—Ä 2: –° —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
```bash
winws2 ^
  --wf-tcp-out=80,443 ^
  --wf-raw-part=@windivert_part.discord_media.txt ^
  --wf-raw-part=@windivert_part.stun.txt ^
  --wf-raw-part=@windivert_part.quic_initial_ietf.txt ^
  --lua-init=@zapret-lib.lua --lua-init=@zapret-antidpi.lua ^
  --filter-tcp=80,443 --filter-l7=http,tls ^
  --lua-desync=fake:blob=fake_default_tls ^
  --new ^
  --filter-l7=quic,stun,discord ^
  --lua-desync=fake:blob=fake_default_quic:repeats=2
```

### –ü—Ä–∏–º–µ—Ä 3: –¢–æ–ª—å–∫–æ QUIC —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
```bash
winws2 ^
  --wf-raw-part=@windivert_part.quic_initial_ietf.txt ^
  --lua-init=@zapret-lib.lua --lua-init=@zapret-antidpi.lua ^
  --filter-l7=quic ^
  --lua-desync=fake:blob=fake_default_quic:repeats=6
```

### –ü—Ä–∏–º–µ—Ä 4: –ü–æ–ª–Ω—ã–π raw —Ñ–∏–ª—å—Ç—Ä
```bash
winws2 ^
  --wf-raw="!impostor and !loopback and outbound and tcp.DstPort=443 and tcp.PayloadLength>0" ^
  --lua-init=@zapret-lib.lua --lua-init=@zapret-antidpi.lua ^
  --filter-tcp=443 ^
  --lua-desync=fake:blob=fake_default_tls
```

---

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ conntrack**
- WinDivert –ù–ï –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–Ω–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ connbytes –∏–∑ iptables)
- –ï—Å–ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–æ—Ä—Ç —Ü–µ–ª–∏–∫–æ–º, –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –∏–¥–µ—Ç —á–µ—Ä–µ–∑ winws2
- –≠—Ç–æ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### 2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —è–∑—ã–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤**
- –ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –±–∏—Ç–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
- –ù–µ—Ç —Å–¥–≤–∏–≥–æ–≤ (shift)
- –ù–µ—Ç –ø–æ–±–∏—Ç–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ (AND, OR, XOR)
- –§–∏–ª—å—Ç—Ä—ã –º–æ–≥—É—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
- –î–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ winws2

### 3. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--wf-raw-part` –¥–ª—è —Ç–æ—á–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ payload
- –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç CPU, –æ—Ç—Å–µ–∫–∞—è –Ω–µ–Ω—É–∂–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞
- –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ `--wf-raw-part` –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

### 4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**
- winws2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `!impostor and !loopback`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä –¥–ª—è SYN/RST/FIN (–¥–ª—è conntrack)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä HTTP redirect (302/307)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ (–µ—Å–ª–∏ `--wf-filter-lan=1`)

---

## üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è WinDivert**

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —è–∑—ã–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤:
https://reqrypt.org/windivert-doc.html#filter_language

---

## üéØ **–†–µ–∑—é–º–µ**

**WinDivert —Ñ–∏–ª—å—Ç—Ä—ã** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤ –≤ Windows –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞:

- **`--wf-tcp-in/out`**, **`--wf-udp-in/out`** ‚Äî –ø—Ä–æ—Å—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä—Ç–∞–º
- **`--wf-raw-part`** ‚Äî —á–∞—Å—Ç–∏—á–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É payload (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!)
- **`--wf-raw`** ‚Äî –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ñ–∏–ª—å—Ç—Ä–æ–º
- **–Ø–∑—ã–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤** ‚Äî –ø–æ—Ö–æ–∂ –Ω–∞ tcpdump, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî —Ñ–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —è–¥—Ä–µ, –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--wf-raw-part` –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏!

## –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `--wf-tcp-out=80,443` –∏ `--wf-tcp-out=80 --wf-tcp-out=443`

### üîç **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**

–ò–∑—É—á–∏–≤ —Ñ—É–Ω–∫—Ü–∏—é `wf_make_pf` –≤ –∫–æ–¥–µ (—Å—Ç—Ä–æ–∫–∏ 1193-1222), —è –º–æ–≥—É —Ç–æ—á–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É:

---

## ‚úÖ **–í–∞—Ä–∏–∞–Ω—Ç 1: `--wf-tcp-out=80,443` (–ü–†–ê–í–ò–õ–¨–ù–´–ô)**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü–∞—Ä–∞–º–µ—Ç—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑**
2. –§—É–Ω–∫—Ü–∏—è `wf_make_pf` –ø–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É `"80,443"` –∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –ø–æ –∑–∞–ø—è—Ç–æ–π
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è **–æ–¥–∏–Ω** —Ñ–∏–ª—å—Ç—Ä WinDivert:
   ```
   ((tcp.DstPort == 80) or (tcp.DstPort == 443))
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û–¥–∏–Ω –≤—ã–∑–æ–≤ –ø–∞—Ä—Å–µ—Ä–∞
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
- ‚úÖ –ú–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## ‚ùå **–í–∞—Ä–∏–∞–Ω—Ç 2: `--wf-tcp-out=80 --wf-tcp-out=443` (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô)**

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `--wf-tcp-out=80` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä: `((tcp.DstPort == 80))`
3. **–í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–¢ –ø–µ—Ä–≤—ã–π!**
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä: `((tcp.DstPort == 443))`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ùå **–ü–µ—Ä–≤—ã–π –ø–æ—Ä—Ç (80) —Ç–µ—Ä—è–µ—Ç—Å—è!**
- ‚ùå –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç (443)
- ‚ùå –î–≤–∞ –≤—ã–∑–æ–≤–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–∏—à–Ω—è—è —Ä–∞–±–æ—Ç–∞)

---

## üìä **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏–∑ –∫–æ–¥–∞**

–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (—Å—Ç—Ä–æ–∫–∏ 2330-2337):

```c
case IDX_WF_TCP_OUT:
    hash_wf_tcp_out = hash_jen(optarg, strlen(optarg));
    if (!wf_make_pf(optarg, "tcp", "SrcPort", params.wf_pf_tcp_src_out, WINDIVERT_PORTFILTER_MAX) ||
        !wf_make_pf(optarg, "tcp", "DstPort", params.wf_pf_tcp_dst_out, WINDIVERT_PORTFILTER_MAX))
    {
        DLOG_ERR("bad value for --wf-tcp-out\n");
        exit_clean(1);
    }
    break;
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `--wf-tcp-out` **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** –±—É—Ñ–µ—Ä—ã `params.wf_pf_tcp_src_out` –∏ `params.wf_pf_tcp_dst_out`, –∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫ –Ω–∏–º!

---

## üî¨ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `wf_make_pf`**

```c
static bool wf_make_pf(char *opt, const char *l4, const char *portname, char *buf, size_t len)
{
    // ...
    for (n = 0, p = opt, *buf = '(', buf[1] = 0; p; n++)  // –ù–∞—á–∏–Ω–∞–µ—Ç —Å '('
    {
        if ((e = strchr(p, ',')))  // –ò—â–µ—Ç –∑–∞–ø—è—Ç—É—é
        {
            c = *e;
            *e = 0;
        }
        if (!pf_parse(p, &pf)) return false;
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É—Å–ª–æ–≤–∏–µ –¥–ª—è –ø–æ—Ä—Ç–∞
        if (pf.from == pf.to)
            snprintf(s1, sizeof(s1), "(%s.%s %s %u)", l4, portname, pf.neg ? "!=" : "==", pf.from);
        
        if (n) strncat(buf, " or ", len - strlen(buf) - 1);  // –î–æ–±–∞–≤–ª—è–µ—Ç "or" –º–µ–∂–¥—É –ø–æ—Ä—Ç–∞–º–∏
        strncat(buf, s1, len - strlen(buf) - 1);
        
        // ...
    }
    strncat(buf, ")", len - strlen(buf) - 1);  // –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–∫–æ–±–∫—É
    return true;
}
```

**–§—É–Ω–∫—Ü–∏—è:**
1. –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É –ø–æ –∑–∞–ø—è—Ç—ã–º
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É—Å–ª–æ–≤–∏–µ
3. –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ `or`
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –≥–æ—Ç–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä

---

## üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

### –í–∞—Ä–∏–∞–Ω—Ç 1: `--wf-tcp-out=80,443`

**–í—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞:**
- 1 –≤—ã–∑–æ–≤ `wf_make_pf`
- 2 –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏
- 1 –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏

**–ò—Ç–æ–≥–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä:**
```
((tcp.DstPort == 80) or (tcp.DstPort == 443))
```

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å WinDivert:** ‚ö° **–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è**
- –û–¥–∏–Ω –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —è–¥—Ä–µ

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: `--wf-tcp-out=80 --wf-tcp-out=443`

**–í—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞:**
- 2 –≤—ã–∑–æ–≤–∞ `wf_make_pf`
- 2 –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
- **–ü–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è!**

**–ò—Ç–æ–≥–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä:**
```
((tcp.DstPort == 443))  // –ü–æ—Ä—Ç 80 –ø–æ—Ç–µ—Ä—è–Ω!
```

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å WinDivert:** ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞**
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Ä—Ç
- –ü–æ—Ä—Ç 80 –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è!

---

## üéØ **–í—ã–≤–æ–¥**

### ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
```bash
--wf-tcp-out=80,443
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
1. ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –æ–±–∞ –ø–æ—Ä—Ç–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è
2. ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ –ø–∞—Ä—Å–∏–Ω–≥** - –æ–¥–∏–Ω –≤—ã–∑–æ–≤ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
3. ‚úÖ **–ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏** - –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
4. ‚úÖ **–ß–∏—Ç–∞–±–µ–ª—å–Ω–µ–µ** - –∫–æ—Ä–æ—á–µ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞

---

### ‚ùå **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
```bash
--wf-tcp-out=80 --wf-tcp-out=443
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. ‚ùå **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!** - —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Ä—Ç (443)
2. ‚ùå **–ú–µ–¥–ª–µ–Ω–Ω–µ–µ** - –ª–∏—à–Ω–∏–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
3. ‚ùå **–ë–æ–ª—å—à–µ –∫–æ–¥–∞** - –¥–ª–∏–Ω–Ω–µ–µ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
4. ‚ùå **–¢–µ—Ä—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ** - –ø–µ—Ä–≤—ã–π –ø–æ—Ä—Ç (80) –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

---

## üìã **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã**

```bash
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ä—Ç–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
--wf-tcp-out=80,443
--wf-tcp-out=80,443,8080,8443
--wf-udp-out=53,443,853

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –¥–∏–∞–ø–∞–∑–æ–Ω—ã
--wf-tcp-out=1000-2000
--wf-tcp-out=80,443,8000-9000

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ
--wf-tcp-out=~443
--wf-tcp-out=~80,~443

# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
--wf-tcp-out=80 --wf-tcp-out=443  # ‚ùå –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ 443!
```

---

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ**

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ `getopt_long` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ**. –ö–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–≤–∞–∂–¥—ã, –≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–≤–æ–≥–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –±—É—Ñ–µ—Ä** (`params.wf_pf_tcp_dst_out`).

–≠—Ç–æ –Ω–µ –±–∞–≥, –∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –¥–∏–∑–∞–π–Ω–∞ - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã WinDivert —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø–∏—Å–∫–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é**.

---

**–ò—Ç–æ–≥:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø—è—Ç—ã–µ –¥–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–µ. –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±—ã—Å—Ç—Ä–µ–µ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ!