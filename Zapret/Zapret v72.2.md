---
tags:
aliases:
img:
---

# üÜï –ù–æ–≤–æ–µ –≤ zapret v72.2

## 1. **`--wssize-forced-cutoff=0|1`** 
### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è Window Size

**–ß—Ç–æ —ç—Ç–æ:**
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (=1) nfqws –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –º–µ–Ω—è—Ç—å TCP window size –ø–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è HTTP request –∏–ª–∏ TLS Client Hello
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ `0` –æ—Ç–∫–ª—é—á–∞–µ—Ç —ç—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏–∫—É

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
- –ò–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å "–¥—É—Ä–∏—Ç—å" DPI –¥–∞–∂–µ –ø–æ—Å–ª–µ Client Hello
- –ü–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ `--wssize-cutoff` –∏–ª–∏ connbytes –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏

---

## 2. **–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ TCP —Ñ–ª–∞–≥–∞–º–∏**
### –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```bash
--dpi-desync-tcp-flags-set=<–∑–Ω–∞—á–µ–Ω–∏–µ>
--dpi-desync-tcp-flags-unset=<–∑–Ω–∞—á–µ–Ω–∏–µ>
--orig-tcp-flags-set=<–∑–Ω–∞—á–µ–Ω–∏–µ>
--orig-tcp-flags-unset=<–∑–Ω–∞—á–µ–Ω–∏–µ>
--dup-tcp-flags-set=<–∑–Ω–∞—á–µ–Ω–∏–µ>
--dup-tcp-flags-unset=<–∑–Ω–∞—á–µ–Ω–∏–µ>
```

**–§–æ—Ä–º–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π:**
- –î–µ—Å—è—Ç–∏—á–Ω–æ–µ —á–∏—Å–ª–æ
- 0xHEX —á–∏—Å–ª–æ (12 –±–∏—Ç)
- –°–ø–∏—Å–æ–∫ —Ñ–ª–∞–≥–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: `FIN,SYN,RST,PSH,ACK,URG,ECE,CWR,AE,R1,R2,R3`

**–§–ª–∞–≥–∏:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ: `FIN, SYN, RST, PSH, ACK, URG, ECE, CWR`
- `AE` - Accurate ECN (–∏–∑ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∏—Ç–æ–≤)
- `R1, R2, R3` - –ø–æ–∫–∞ –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –±–∏—Ç—ã

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω–≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ñ–ª–∞–≥–æ–≤ –¥–ª—è –æ–±–º–∞–Ω–∞ DPI
- –ù–∞–ø—Ä–∏–º–µ—Ä: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ SYN –≤ —Ñ–µ–π–∫–∞—Ö
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `datanoack`: `--dpi-desync-tcp-flags-unset=ACK`

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ú–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å NAT (–æ—Å–æ–±–µ–Ω–Ω–æ Linux-based). –î–ª—è –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è nftables.

---

## 3. **`--dup-ip-id=same|zero|seq|rnd`**
### –†–µ–∂–∏–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è IP_ID –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–†–µ–∂–∏–º—ã:**
- `same` - –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–º –∂–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `zero` - ip_id=0
- `seq` - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç
- `rnd` - —Å–ª—É—á–∞–π–Ω—ã–π

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—É `--ip-id`**, –Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∫ –¥—É–±–ª–∏–∫–∞—Ç–∞–º (`--dup`).

---

## üí° –ò—Ç–æ–≥–æ

–í–µ—Ä—Å–∏—è 72.2 –¥–æ–±–∞–≤–ª—è–µ—Ç:
1. –ë–æ–ª–µ–µ –≥–∏–±–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏—è Window Size
2. –ú–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ TCP —Ñ–ª–∞–≥–∞–º–∏ (12 –±–∏—Ç)
3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ IP_ID –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

–≠—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–∞—é—Ç –±–æ–ª—å—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ–±—Ö–æ–¥–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö DPI, –∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç –∞–Ω–æ–º–∞–ª–∏–∏ –≤ TCP —Ñ–ª–∞–≥–∞—Ö –∏ IP_ID –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö.