---
tags:
link:
aliases:
img:
---

## üìã **–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ**

`--lua-desync` ‚Äî —ç—Ç–æ **–≥–ª–∞–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º** desync –≤ nfqws2. –û–Ω –≤—ã–∑—ã–≤–∞–µ—Ç Lua —Ñ—É–Ω–∫—Ü–∏—é **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞**, –ø—Ä–æ—Ö–æ–¥—è—â–µ–≥–æ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ñ–∏–ª—å.

### **–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```bash
--lua-desync=<—Ñ—É–Ω–∫—Ü–∏—è>[:–ø–∞—Ä–∞–º–µ—Ç—Ä1=–∑–Ω–∞—á–µ–Ω–∏–µ1[:–ø–∞—Ä–∞–º–µ—Ç—Ä2=–∑–Ω–∞—á–µ–Ω–∏–µ2]]
```

---

## üîß **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**

```
–ü–∞–∫–µ—Ç ‚Üí –ø—Ä–æ—Ñ–∏–ª—å ‚Üí --lua-desync ‚Üí Lua —Ñ—É–Ω–∫—Ü–∏—è ‚Üí –¥–µ–π—Å—Ç–≤–∏–µ
```

1. –ü–∞–∫–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–æ—Ñ–∏–ª—è (`--filter-tcp`, `--filter-l7`, `--hostlist`)
2. –ï—Å–ª–∏ –ø–∞–∫–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞–º ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è Lua —Ñ—É–Ω–∫—Ü–∏—è
3. –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç fake, —Ä–∞–∑–±–∏–≤–∞–µ—Ç –ø–∞–∫–µ—Ç, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∏ —Ç.–¥.)
4. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–¥–∏–∫—Ç (`VERDICT_PASS`, `VERDICT_DROP`, `VERDICT_MODIFY`)

---

## üì¶ **–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `zapret-antidpi.lua`**

### –ë–∞–∑–æ–≤—ã–µ:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `drop` | –û—Ç–±—Ä–æ—Å–∏—Ç—å –ø–∞–∫–µ—Ç |
| `send` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç –∫–∞–∫ –µ—Å—Ç—å (—Å –≤–æ–∑–º–æ–∂–Ω–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤) |
| `pktmod` | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞ (fooling) |

### HTTP –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `http_domcase` | –ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –¥–æ–º–µ–Ω–∞ (HoSt) |
| `http_hostcase` | –ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞ Host |
| `http_methodeol` | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–µ—Ü —Å—Ç—Ä–æ–∫–∏ –º–µ—Ç–æ–¥–∞ |

### TCP —Å–ø–ª–∏—Ç –∏ disorder:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `multisplit` | –†–∞–∑–±–∏—Ç—å –ø–∞–∫–µ—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ TCP —Å–µ–≥–º–µ–Ω—Ç–æ–≤ |
| `multidisorder` | –†–∞–∑–±–∏—Ç—å + –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ |
| `tcpseg` | TCP —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è |

### Fake-–∞—Ç–∞–∫–∏:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `fake` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å fake –ø–∞–∫–µ—Ç |
| `fakedsplit` | Fake + —Å–ø–ª–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ |
| `fakeddisorder` | Fake + disorder –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ |
| `hostfakesplit` | Fake —Ç–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞ + —Å–ø–ª–∏—Ç |

### SYN-–∞—Ç–∞–∫–∏:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `syndata` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å SYN —Å –¥–∞–Ω–Ω—ã–º–∏ |
| `synack` | –†–∞–±–æ—Ç–∞ —Å SYN/ACK |
| `synack_split` | –°–ø–ª–∏—Ç –ø–æ SYN/ACK |

### Window size:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `wsize` | –ò–∑–º–µ–Ω–∏—Ç—å window size –Ω–∞ SYN-ACK |
| `wssize` | –ò–∑–º–µ–Ω–∏—Ç—å window size –Ω–∞ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö |

### –ü—Ä–æ—á–µ–µ:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `rst` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å RST |
| `udplen` | –ò–∑–º–µ–Ω–∏—Ç—å –¥–ª–∏–Ω—É UDP |
| `dht_dn` | DHT domain name injection |

### –ò–∑ `zapret-lib.lua`:
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `pass` | –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) |
| `pktdebug` | –í—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ desync –≤ –ª–æ–≥ |
| `argdebug` | –í—ã–≤–µ—Å—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –ª–æ–≥ |
| `posdebug` | –í—ã–≤–µ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ conntrack |
| `luaexec` | –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π Lua –∫–æ–¥ |

---

## üí° **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### –ü—Ä–æ—Å—Ç–æ–π fake:
```bash
--lua-desync=fake:blob=fake_default_tls
```

### Fake —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```bash
--lua-desync=fake:blob=fake_default_tls:tcp_md5:ip_ttl=3:repeats=5
```

### Multisplit:
```bash
--lua-desync=multisplit:pos=1,midsld
```

### –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π:
```bash
--lua-desync=fake:blob=fake_default_tls:tcp_md5 \
--lua-desync=multisplit:pos=1,midsld
```

### –° —Ñ–∏–ª—å—Ç—Ä–æ–º payload:
```bash
--payload=tls_client_hello --lua-desync=fake:blob=fake_default_tls \
--payload=http_req --lua-desync=fake:blob=fake_default_http
```

---

## üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**

```bash
--lua-desync=—Ñ—É–Ω–∫—Ü–∏—è:param1=val1:param2=val2:param3
            ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                     ‚îÇ
         –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –¥–≤–æ–µ—Ç–æ—á–∏–µ
```

**–¢–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
- `param=value` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º
- `param` ‚Äî –±—É–ª–µ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä (–±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è = true)

---

## üîç **–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**

–ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É `desync` —Å –¥–∞–Ω–Ω—ã–º–∏:

```lua
desync = {
    -- –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏
    arg = { blob = "...", tcp_md5 = true, ... },
    
    -- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ—É–Ω–∫—Ü–∏–∏
    func = "fake",
    func_n = 1,
    func_instance = "1:fake:1",
    
    -- –î–∏—Å—Å–µ–∫—Ç –ø–∞–∫–µ—Ç–∞
    dis = {
        ip = { ... },      -- –∏–ª–∏ ip6 = { ... }
        tcp = { ... },     -- –∏–ª–∏ udp = { ... }
        payload = "...",
    },
    
    -- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    outgoing = true/false,
    
    -- –¢–∏–ø payload
    l7payload = "tls_client_hello",
    
    -- Conntrack (–µ—Å–ª–∏ –µ—Å—Ç—å)
    track = {
        lua_state = {},    -- –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
        tcp = { seq = ..., ack = ... },
        ...
    },
    
    -- Reassembled –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    reasm_data = "...",
    
    -- –î—Ä—É–≥–∏–µ –ø–æ–ª—è...
}
```

---

## üéØ **–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä**

```bash
winws2 ^
  --wf-tcp-out=80,443 ^
  --lua-init=@zapret-lib.lua --lua-init=@zapret-antidpi.lua ^
  --filter-tcp=80 --filter-l7=http ^
  --payload=http_req --lua-desync=fake:blob=fake_default_http:tcp_md5 ^
  --lua-desync=multisplit:pos=method+2 ^
  --new ^
  --filter-tcp=443 --filter-l7=tls ^
  --payload=tls_client_hello --lua-desync=fake:blob=fake_default_tls:tcp_md5:tls_mod=rnd,rndsni ^
  --lua-desync=multidisorder:pos=1,midsld
```

---

## ‚úÖ **–ò—Ç–æ–≥**

**`--lua-desync`** ‚Äî —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ nfqws2:
- üîπ –í—ã–∑—ã–≤–∞–µ—Ç Lua —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- üîπ –ü–µ—Ä–µ–¥–∞—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –¥–≤–æ–µ—Ç–æ—á–∏–µ
- üîπ –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
- üîπ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ `--payload`, `--out-range`, `--in-range`
- üîπ –ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏

## üìã **–ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ñ—É–Ω–∫—Ü–∏–π `--lua-desync`**

### üîπ **–ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (zapret-lib.lua)**

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|----------|-----------|
| `pass` | –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) | ‚Äî |
| `pktdebug` | –í—ã–≤–æ–¥–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ desync –≤ –ª–æ–≥ | ‚Äî |
| `argdebug` | –í—ã–≤–æ–¥–∏—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ª–æ–≥ | ‚Äî |
| `posdebug` | –í—ã–≤–æ–¥–∏—Ç –ø–æ–∑–∏—Ü–∏–∏ conntrack –≤ –ª–æ–≥ | ‚Äî |
| `luaexec` | –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π Lua –∫–æ–¥ | `code=<lua_code>` |

---

### üîπ **–§—É–Ω–∫—Ü–∏–∏ –∏–∑ zapret-antidpi.lua**

#### **–ë–∞–∑–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `drop` | ‚Äî | –û—Ç–±—Ä–æ—Å–∏—Ç—å –ø–∞–∫–µ—Ç | `dir`, `payload` |
| `send` | `--dup` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–ø–∏—é –ø–∞–∫–µ—Ç–∞ | `dir`, fooling, `ip_id`, `ipfrag`, `rawsend`, `reconstruct` |
| `pktmod` | `--orig` | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç | `dir`, fooling, `ip_id` |

---

#### **HTTP –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `http_domcase` | `--domcase` | –ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –¥–æ–º–µ–Ω–∞ (HoSt) | `dir` |
| `http_hostcase` | `--hostcase` | –ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞ Host | `dir`, `spell=<str>` (4 —Å–∏–º–≤–æ–ª–∞) |
| `http_methodeol` | `--methodeol` | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å EOL –º–µ—Ç–æ–¥–∞ | `dir`, `method=cr\|lf\|crlf\|lfcr`, `no_space` |

---

#### **SYN-–∞—Ç–∞–∫–∏**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `syndata` | `--dpi-desync=syndata` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å SYN —Å –¥–∞–Ω–Ω—ã–º–∏ | `blob=<blob>`, `tls_mod=<list>`, fooling, `rawsend`, `reconstruct`, `ipfrag` |
| `synack` | ‚Äî | –û—Ç–ø—Ä–∞–≤–∏—Ç—å SYN-ACK | fooling, `rawsend`, `reconstruct`, `ipfrag` |
| `synack_split` | ‚Äî | –°–ø–ª–∏—Ç –ø–æ SYN-ACK | `pos=<posmarker>`, `seqovl=N`, `seqovl_pattern=<blob>` |

---

#### **Window size**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `wsize` | `--wssize` | –ò–∑–º–µ–Ω–∏—Ç—å window size –Ω–∞ SYN-ACK | `wsize=N`, `scale=N` |
| `wssize` | `--wssize` | –ò–∑–º–µ–Ω–∏—Ç—å window size –Ω–∞ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö | `wsize=N`, `scale=N` |

---

#### **RST**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `rst` | `--dpi-desync=rst` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å RST | `dir`, `payload`, fooling, `ip_id`, `rawsend`, `reconstruct`, `ipfrag`, `rstack` |

---

#### **Fake-–∞—Ç–∞–∫–∏**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `fake` | `--dpi-desync=fake` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å fake –ø–∞–∫–µ—Ç | `blob=<blob>` *(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)*, `tls_mod=<list>`, `dir`, `payload`, fooling, `ip_id`, `rawsend`, `reconstruct`, `ipfrag` |

---

#### **–°–ø–ª–∏—Ç –∏ disorder**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `multisplit` | `--dpi-desync=multisplit` | –†–∞–∑–±–∏—Ç—å –Ω–∞ TCP —Å–µ–≥–º–µ–Ω—Ç—ã | `pos=<posmarker_list>`, `seqovl=N`, `seqovl_pattern=<blob>`, `blob=<blob>`, `nodrop` |
| `multidisorder` | `--dpi-desync=multidisorder` | –†–∞–∑–±–∏—Ç—å + –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ | `pos=<posmarker_list>`, `seqovl=<posmarker>`, `seqovl_pattern=<blob>`, `blob=<blob>`, `nodrop` |
| `tcpseg` | ‚Äî | TCP —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É | `pos=<range>` *(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)*, `seqovl=N`, `seqovl_pattern=<blob>`, `blob=<blob>` |

---

#### **Fake + —Å–ø–ª–∏—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `hostfakesplit` | `--dpi-desync=hostfakesplit` | Fake —Ç–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞ + —Å–ø–ª–∏—Ç | `host=<template>`, `midhost=<posmarker>`, `nofake1`, `nofake2`, `disorder_after=<posmarker>`, `blob=<blob>`, `nodrop` |
| `fakedsplit` | `--dpi-desync=fakedsplit` | Fake + —Å–ø–ª–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ | `pos=<posmarker>`, `nofake1`, `nofake2`, `nofake3`, `nofake4`, `pattern=<blob>`, `seqovl=N`, `seqovl_pattern=<blob>`, `blob=<blob>`, `nodrop` |
| `fakeddisorder` | `--dpi-desync=fakeddisorder` | Fake + disorder –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ | `pos=<posmarker>`, `nofake1`, `nofake2`, `nofake3`, `nofake4`, `pattern=<blob>`, `seqovl=<posmarker>`, `seqovl_pattern=<blob>`, `blob=<blob>`, `nodrop` |

---

#### **UDP**

| –§—É–Ω–∫—Ü–∏—è | –ê–Ω–∞–ª–æ–≥ nfqws1 | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|---------------|----------|-----------|
| `udplen` | `--dpi-desync=udplen` | –ò–∑–º–µ–Ω–∏—Ç—å –¥–ª–∏–Ω—É UDP –ø–∞–∫–µ—Ç–∞ | `dir`, `payload`, `min=N`, `max=N`, `increment=N` (–ø–æ —É–º–æ–ª—á. 2), `pattern=<blob>`, `pattern_offset=N` |
| `dht_dn` | `--dpi-desync=tamper` (dht) | DHT domain name injection | `dir`, `dn=N` (–ø–æ —É–º–æ–ª—á. 2) |

---

## üîß **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–ø—Ä–∏–º–µ–Ω–∏–º—ã –∫–æ –º–Ω–æ–≥–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º)**

### **Direction (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `dir=in` | –¢–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã |
| `dir=out` | –¢–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| `dir=any` | –û–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è |

### **Payload —Ñ–∏–ª—å—Ç—Ä**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `payload=<type_list>` | –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É payload |

### **Fooling (–æ–±–º–∞–Ω–∫–∏)**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `ip_ttl=N` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TTL IPv4 |
| `ip6_ttl=N` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Hop Limit IPv6 |
| `ip_autottl=delta,min-max` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π TTL |
| `ip6_autottl=delta,min-max` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Hop Limit |
| `ip6_hopbyhop[=hex]` | –î–æ–±–∞–≤–∏—Ç—å Hop-by-Hop –∑–∞–≥–æ–ª–æ–≤–æ–∫ |
| `ip6_hopbyhop2[=hex]` | –í—Ç–æ—Ä–æ–π Hop-by-Hop |
| `ip6_destopt[=hex]` | –î–æ–±–∞–≤–∏—Ç—å Destination Options |
| `ip6_destopt2[=hex]` | –í—Ç–æ—Ä–æ–π Destination Options |
| `ip6_routing[=hex]` | –î–æ–±–∞–≤–∏—Ç—å Routing –∑–∞–≥–æ–ª–æ–≤–æ–∫ |
| `ip6_ah[=hex]` | –î–æ–±–∞–≤–∏—Ç—å Authentication Header |
| `tcp_seq=N` | –î–æ–±–∞–≤–∏—Ç—å –∫ TCP sequence |
| `tcp_ack=N` | –î–æ–±–∞–≤–∏—Ç—å –∫ TCP ack |
| `tcp_ts=N` | –î–æ–±–∞–≤–∏—Ç—å –∫ timestamp |
| `tcp_md5[=hex]` | –î–æ–±–∞–≤–∏—Ç—å TCP MD5 –æ–ø—Ü–∏—é |
| `tcp_flags_set=<list>` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TCP —Ñ–ª–∞–≥–∏ |
| `tcp_flags_unset=<list>` | –°–Ω—è—Ç—å TCP —Ñ–ª–∞–≥–∏ |
| `tcp_ts_up` | –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å timestamp –Ω–∞–≤–µ—Ä—Ö |
| `fool=<function>` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–º–∞–Ω–∫–∏ |

### **Reconstruct**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `badsum` | –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ L4 |

### **Rawsend**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `repeats=N` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ |
| `ifout=<iface>` | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| `fwmark=N` | fwmark –ø–∞–∫–µ—Ç–∞ |

### **IP ID**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `ip_id=seq\|rnd\|zero\|none` | –ü–æ–ª–∏—Ç–∏–∫–∞ IP ID |
| `ip_id_conn` | –°–æ—Ö—Ä–∞–Ω—è—Ç—å IP ID –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏ |

### **IP —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `ipfrag[=function]` | –í–∫–ª—é—á–∏—Ç—å IP —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é |
| `ipfrag_disorder` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ |
| `ipfrag_pos_tcp=N` | –ü–æ–∑–∏—Ü–∏—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ TCP (–∫—Ä–∞—Ç–Ω–æ 8) |
| `ipfrag_pos_udp=N` | –ü–æ–∑–∏—Ü–∏—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ UDP (–∫—Ä–∞—Ç–Ω–æ 8) |
| `ipfrag_next=N` | Next proto –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ |

### **TLS –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `tls_mod=rnd` | –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ random |
| `tls_mod=rndsni` | –°–ª—É—á–∞–π–Ω—ã–π SNI |
| `tls_mod=sni=<domain>` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π SNI |
| `tls_mod=dupsid` | –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Session ID |
| `tls_mod=padencap` | Padding encapsulation |

---

## üìç **Position markers (–º–∞—Ä–∫–µ—Ä—ã –ø–æ–∑–∏—Ü–∏–π)**

| –ú–∞—Ä–∫–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `N` | –ê–±—Å–æ–ª—é—Ç–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (—á–∏—Å–ª–æ) |
| `-N` | –ü–æ–∑–∏—Ü–∏—è —Å –∫–æ–Ω—Ü–∞ |
| `host` | –ù–∞—á–∞–ª–æ —Ö–æ—Å—Ç–∞ |
| `endhost` | –ö–æ–Ω–µ—Ü —Ö–æ—Å—Ç–∞ |
| `sld` | Second-level domain |
| `midsld` | –°–µ—Ä–µ–¥–∏–Ω–∞ SLD |
| `endsld` | –ö–æ–Ω–µ—Ü SLD |
| `method` | HTTP –º–µ—Ç–æ–¥ |
| `extlen` | TLS extensions length |
| `sniext` | TLS SNI extension |
| `marker+N` | –ú–∞—Ä–∫–µ—Ä + —Å–º–µ—â–µ–Ω–∏–µ |
| `marker-N` | –ú–∞—Ä–∫–µ—Ä - —Å–º–µ—â–µ–Ω–∏–µ |

---

## üí° **–ü—Ä–∏–º–µ—Ä—ã**

```bash
# –ü—Ä–æ—Å—Ç–æ–π fake
--lua-desync=fake:blob=fake_default_tls:tcp_md5

# Fake —Å TTL –∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏
--lua-desync=fake:blob=fake_default_tls:ip_ttl=3:repeats=5:tls_mod=rnd,rndsni

# Multisplit —Å seqovl
--lua-desync=multisplit:pos=1,midsld:seqovl=10

# Fakedsplit
--lua-desync=fakedsplit:pos=midsld:nofake1:tcp_md5

# –ö–æ–º–±–∏–Ω–∞—Ü–∏—è fake + multidisorder
--lua-desync=fake:blob=fake_default_tls:tcp_md5 --lua-desync=multidisorder:pos=1,midsld

# UDP length
--lua-desync=udplen:increment=4:min=50
```

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–ª–∞–≥–æ–≤ nfqws1 ‚Üí nfqws2

–í nfqws1 –±—ã–ª–∏ –≥–æ—Ç–æ–≤—ã–µ —Ñ–ª–∞–≥–∏ `--dpi-desync-fooling=`. –í nfqws2 –∏—Ö –Ω–µ—Ç ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.

---

## üìã **–¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è**

| nfqws1 —Ñ–ª–∞–≥ | nfqws2 –ø–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|-----------------|----------|
| `md5sig` | `tcp_md5` | –î–æ–±–∞–≤–∏—Ç—å TCP MD5 signature –æ–ø—Ü–∏—é |
| `badsum` | `badsum` | –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ L4 |
| `badseq` | `tcp_seq=-10000` | –°–¥–≤–∏–Ω—É—Ç—å TCP sequence (–¥–ª—è SYN) |
| `badseq` | `tcp_ack=-66000` | –°–¥–≤–∏–Ω—É—Ç—å TCP ack (–¥–ª—è –¥–∞–Ω–Ω—ã—Ö) |
| `datanoack` | `tcp_flags_unset=ack` | –°–Ω—è—Ç—å —Ñ–ª–∞–≥ ACK |
| `badack` | `tcp_ack=-66000` | –°–¥–≤–∏–Ω—É—Ç—å TCP ack |
| `hopbyhop` | `ip6_hopbyhop` | IPv6 Hop-by-Hop header |
| `hopbyhop2` | `ip6_hopbyhop2` | –í—Ç–æ—Ä–æ–π Hop-by-Hop header |
| `destopt` | `ip6_destopt` | IPv6 Destination Options |
| `destopt2` | `ip6_destopt2` | –í—Ç–æ—Ä–æ–π Destination Options |
| `ipfrag1` | `ipfrag` | IP —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è |

---

## üîß **–î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–ª–∞–≥–∞**

### **`md5sig` ‚Üí `tcp_md5`**
–î–æ–±–∞–≤–ª—è–µ—Ç TCP –æ–ø—Ü–∏—é MD5 signature (RFC 2385). DPI –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å.

```bash
# nfqws1
--dpi-desync-fooling=md5sig

# nfqws2
--lua-desync=fake:blob=fake_default_tls:tcp_md5
```

### **`badsum` ‚Üí `badsum`**
–î–µ–ª–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Å—É–º–º—É TCP/UDP –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π. –°–µ—Ä–≤–µ—Ä –æ—Ç–±—Ä–æ—Å–∏—Ç –ø–∞–∫–µ—Ç.

```bash
# nfqws1
--dpi-desync-fooling=badsum

# nfqws2
--lua-desync=fake:blob=fake_default_tls:badsum
```

### **`badseq` ‚Üí `tcp_seq` / `tcp_ack`**
–í nfqws1 `badseq` –ø—Ä–∏–º–µ–Ω—è–ª —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è SYN –∏ –æ–±—ã—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤:
- SYN –ø–∞–∫–µ—Ç—ã: `tcp_seq=-10000`
- –û–±—ã—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã: `tcp_ack=-66000`

```bash
# nfqws1
--dpi-desync-fooling=badseq

# nfqws2 (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤)
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000

# nfqws2 (–¥–ª—è SYN)
--lua-desync=fake:blob=fake_default_tls:tcp_seq=-10000
```

### **`badack` ‚Üí `tcp_ack`**
–°–¥–≤–∏–≥–∞–µ—Ç TCP acknowledgment number.

```bash
# nfqws1
--dpi-desync-fooling=badack

# nfqws2
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000
```

**–í–∞–∂–Ω–æ!** –î–ª—è Linux –Ω—É–∂–µ–Ω `tcp_ts_up` —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –±–µ–∑ `badseq`:
```bash
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000:tcp_ts_up
```

### **`datanoack` ‚Üí `tcp_flags_unset=ack`**
–°–Ω–∏–º–∞–µ—Ç —Ñ–ª–∞–≥ ACK —Å –ø–∞–∫–µ—Ç–∞.

```bash
# nfqws1
--dpi-desync-fooling=datanoack

# nfqws2
--lua-desync=fake:blob=fake_default_tls:tcp_flags_unset=ack
```

### **`hopbyhop` ‚Üí `ip6_hopbyhop`**
–î–æ–±–∞–≤–ª—è–µ—Ç IPv6 Hop-by-Hop extension header.

```bash
# nfqws1
--dpi-desync-fooling=hopbyhop

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip6_hopbyhop
```

### **`hopbyhop2` ‚Üí `ip6_hopbyhop2`**
–î–æ–±–∞–≤–ª—è–µ—Ç **–≤—Ç–æ—Ä–æ–π** Hop-by-Hop header (–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ, –ª–æ–º–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É).

```bash
# nfqws1
--dpi-desync-fooling=hopbyhop2

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip6_hopbyhop2
```

### **`destopt` ‚Üí `ip6_destopt`**
–î–æ–±–∞–≤–ª—è–µ—Ç IPv6 Destination Options header.

```bash
# nfqws1
--dpi-desync-fooling=destopt

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip6_destopt
```

### **`ipfrag1` ‚Üí `ipfrag`**
IP —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞.

```bash
# nfqws1
--dpi-desync-fooling=ipfrag1

# nfqws2
--lua-desync=send:ipfrag
```

---

## üí° **–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–±–∏–Ω–∞—Ü–∏–π**

### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π fake —Å md5sig:
```bash
# nfqws1
--dpi-desync=fake --dpi-desync-fooling=md5sig

# nfqws2
--lua-desync=fake:blob=fake_default_tls:tcp_md5
```

### Fake —Å badseq + md5sig:
```bash
# nfqws1
--dpi-desync=fake --dpi-desync-fooling=badseq,md5sig

# nfqws2
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000:tcp_md5
```

### Fake —Å TTL:
```bash
# nfqws1
--dpi-desync=fake --dpi-desync-ttl=3

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip_ttl=3
```

### Fake —Å autottl:
```bash
# nfqws1
--dpi-desync=fake --dpi-desync-autottl=-1,3-20

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip_autottl=-1,3-20:ip6_autottl=-1,3-20
```

### Fakedsplit —Å badseq + md5sig:
```bash
# nfqws1
--dpi-desync=fakedsplit --dpi-desync-fooling=badseq,md5sig --dpi-desync-split-pos=2

# nfqws2
--lua-desync=fakedsplit:pos=2:tcp_ack=-66000:tcp_md5
```

### IPv6 hopbyhop + destopt:
```bash
# nfqws1
--dpi-desync=fake --dpi-desync-fooling=hopbyhop,destopt

# nfqws2
--lua-desync=fake:blob=fake_default_tls:ip6_hopbyhop:ip6_destopt
```

---

## üìù **–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ fooling –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ nfqws2**

| –ü–∞—Ä–∞–º–µ—Ç—Ä          | –ó–Ω–∞—á–µ–Ω–∏–µ       | –û–ø–∏—Å–∞–Ω–∏–µ                     |
| ----------------- | -------------- | ---------------------------- |
| `tcp_md5`         | `[=hex]`       | TCP MD5 signature (16 –±–∞–π—Ç)  |
| `tcp_seq`         | `=N`           | –°–¥–≤–∏–≥ TCP sequence           |
| `tcp_ack`         | `=N`           | –°–¥–≤–∏–≥ TCP ack                |
| `tcp_ts`          | `=N`           | –°–¥–≤–∏–≥ TCP timestamp          |
| `tcp_flags_set`   | `=list`        | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TCP —Ñ–ª–∞–≥–∏         |
| `tcp_flags_unset` | `=list`        | –°–Ω—è—Ç—å TCP —Ñ–ª–∞–≥–∏              |
| `tcp_ts_up`       | ‚Äî              | –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å timestamp –Ω–∞–≤–µ—Ä—Ö |
| `badsum`          | ‚Äî              | –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ |
| `ip_ttl`          | `=N`           | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TTL               |
| `ip6_ttl`         | `=N`           | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Hop Limit         |
| `ip_autottl`      | =delta,min-max | –ê–≤—Ç–æ TTL                     |
| `ip6_autottl`     | =delta,min-max | –ê–≤—Ç–æ Hop Limit               |
| `ip6_hopbyhop`    | `[=hex]`       | Hop-by-Hop header            |
| `ip6_hopbyhop2`   | `[=hex]`       | –í—Ç–æ—Ä–æ–π Hop-by-Hop            |
| `ip6_destopt`     | `[=hex]`       | Destination Options          |
| `ip6_destopt2`    | `[=hex]`       | –í—Ç–æ—Ä–æ–π Destination Options   |
| `ip6_routing`     | `[=hex]`       | Routing header               |
| `ip6_ah`          | `[=hex]`       | Authentication header        |

---

## ‚ö° **–ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞**

```bash
# md5sig
:tcp_md5

# badsum
:badsum

# badseq (–¥–ª—è –¥–∞–Ω–Ω—ã—Ö)
:tcp_ack=-66000

# badseq (–¥–ª—è SYN)
:tcp_seq=-10000

# badack
:tcp_ack=-66000:tcp_ts_up

# datanoack
:tcp_flags_unset=ack

# TTL
:ip_ttl=3:ip6_ttl=3

# autottl
:ip_autottl=-1,3-20:ip6_autottl=-1,3-20

# IPv6 headers
:ip6_hopbyhop:ip6_destopt
```

## –ù–µ—Ç, `badseq` –∏ `badack` ‚Äî —ç—Ç–æ **—Ä–∞–∑–Ω—ã–µ** –≤–µ—â–∏!

---

## üìä **–†–∞–∑–Ω–∏—Ü–∞**

| –§–ª–∞–≥ | –ß—Ç–æ –º–µ–Ω—è–µ—Ç | –ü–æ–ª–µ TCP | –¢–∏–ø–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|----------|-------------------|
| **`badseq`** | Sequence number | `tcp.th_seq` | `-10000` |
| **`badack`** | Acknowledgment number | `tcp.th_ack` | `-66000` |

---

## üî¨ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç**

### **`badseq` (tcp_seq)**
–°–¥–≤–∏–≥–∞–µ—Ç **–Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (sequence number) –ø–∞–∫–µ—Ç–∞.

```
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç:  seq=1000, ack=5000
–° badseq (-10000):   seq=-9000 (990), ack=5000
```

- –°–µ—Ä–≤–µ—Ä –≤–∏–¥–∏—Ç –ø–∞–∫–µ—Ç —Å "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º" seq
- –ü–∞–∫–µ—Ç **–Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ–∫–Ω–æ –ø—Ä–∏—ë–º–∞** ‚Üí –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è
- DPI –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞–∫–µ—Ç, –Ω–æ —Å–µ—Ä–≤–µ—Ä –µ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç

### **`badack` (tcp_ack)**
–°–¥–≤–∏–≥–∞–µ—Ç **–Ω–æ–º–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** (acknowledgment number) –ø–∞–∫–µ—Ç–∞.

```
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç:  seq=1000, ack=5000
–° badack (-66000):   seq=1000, ack=-61000
```

- –°–µ—Ä–≤–µ—Ä –≤–∏–¥–∏—Ç –ø–∞–∫–µ—Ç —Å "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º" ack
- –ü–∞–∫–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–±—Ä–æ—à–µ–Ω –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –û–°)
- –ù–∞ Linux —Å –æ–ø—Ü–∏–µ–π timestamp –ø–∞–∫–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–Ω—è—Ç!

---

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–π –Ω—é–∞–Ω—Å –¥–ª—è Linux**

–ù–∞ Linux **badack –±–µ–∑ badseq** –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å TCP timestamp –æ–ø—Ü–∏—è!

Linux –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã —Å –ø–ª–æ—Ö–∏–º ack —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ timestamp –æ–ø—Ü–∏—è –∏–¥—ë—Ç **–ø–µ—Ä–≤–æ–π** –≤ —Å–ø–∏—Å–∫–µ TCP –æ–ø—Ü–∏–π.

–ü–æ—ç—Ç–æ–º—É –≤ nfqws2 –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä **`tcp_ts_up`** ‚Äî –æ–Ω –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç timestamp –Ω–∞–≤–µ—Ä—Ö:

```bash
# –ß—Ç–æ–±—ã badack —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ Linux:
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000:tcp_ts_up
```

---

## üìù **–í nfqws1**

–í nfqws1 —Ñ–ª–∞–≥ `badseq` –±—ã–ª **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º** –∏ –ø—Ä–∏–º–µ–Ω—è–ª —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø–∞–∫–µ—Ç–∞:

| –¢–∏–ø –ø–∞–∫–µ—Ç–∞ | –ß—Ç–æ –º–µ–Ω—è–ª–æ—Å—å | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------------|----------|
| SYN | `tcp_seq` | `-10000` |
| –î–∞–Ω–Ω—ã–µ | `tcp_ack` | `-66000` |

–ü–æ—ç—Ç–æ–º—É `--dpi-desync-fooling=badseq` —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–ª **–ª–∏–±–æ seq, –ª–∏–±–æ ack** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

---

## üéØ **–í nfqws2**

–í nfqws2 –Ω–µ—Ç —Ç–∞–∫–æ–π "–º–∞–≥–∏–∏" ‚Äî –≤—ã **—è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç–µ** —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å:

```bash
# –ò–∑–º–µ–Ω–∏—Ç—å sequence (–¥–ª—è SYN)
:tcp_seq=-10000

# –ò–∑–º–µ–Ω–∏—Ç—å ack (–¥–ª—è –¥–∞–Ω–Ω—ã—Ö)
:tcp_ack=-66000

# –ò–∑–º–µ–Ω–∏—Ç—å –æ–±–∞
:tcp_seq=-10000:tcp_ack=-66000
```

---

## üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

### –î–ª—è fake –ø–∞–∫–µ—Ç–æ–≤ (–¥–∞–Ω–Ω—ã–µ):
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: badack —Å tcp_ts_up (–Ω–∞–¥—ë–∂–Ω–µ–µ –Ω–∞ Linux)
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000:tcp_ts_up

# –í–∞—Ä–∏–∞–Ω—Ç 2: md5sig (–ø—Ä–æ—â–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ)
--lua-desync=fake:blob=fake_default_tls:tcp_md5

# –í–∞—Ä–∏–∞–Ω—Ç 3: TTL (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ DPI)
--lua-desync=fake:blob=fake_default_tls:ip_ttl=3
```

### –î–ª—è syndata (SYN –ø–∞–∫–µ—Ç—ã):
```bash
--lua-desync=syndata:blob=fake_default_tls:tcp_seq=-10000
```

---

## ‚úÖ **–ò—Ç–æ–≥**

| | `badseq` | `badack` |
|---|---------|---------|
| **–ü–æ–ª–µ** | Sequence | Acknowledgment |
| **nfqws2 –ø–∞—Ä–∞–º–µ—Ç—Ä** | `tcp_seq=N` | `tcp_ack=N` |
| **–¢–∏–ø–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** | `-10000` | `-66000` |
| **–î–ª—è SYN** | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| **–î–ª—è –¥–∞–Ω–Ω—ã—Ö** | ‚ö†Ô∏è –†–µ–¥–∫–æ | ‚úÖ –î–∞ |
| **–ù—É–∂–µ–Ω tcp_ts_up** | –ù–µ—Ç | –î–∞ (–Ω–∞ Linux) |

**–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç:** `badseq` –º–µ–Ω—è–µ—Ç **seq**, `badack` –º–µ–Ω—è–µ—Ç **ack** ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è TCP –∑–∞–≥–æ–ª–æ–≤–∫–∞.

## `tcp_ts_up` ‚Äî –Ω—É–∂–µ–Ω **–Ω–µ –≤—Å–µ–≥–¥–∞**, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Linux

---

## üîç **–ö–æ–≥–¥–∞ `tcp_ts_up` –ù–£–ñ–ï–ù**

**–¢–æ–ª—å–∫–æ –Ω–∞ Linux**, –∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
1. –í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `tcp_ack` (badack) **–±–µ–∑** `tcp_seq` (badseq)
2. –í –ø–∞–∫–µ—Ç–µ **–µ—Å—Ç—å** TCP timestamp –æ–ø—Ü–∏—è

### –ü–æ—á–µ–º—É?

Linux –ø—Ä–æ–≤–µ—Ä—è–µ—Ç timestamp –æ–ø—Ü–∏—é –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤. –ù–æ –µ—Å—Ç—å –±–∞–≥/–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:
- Linux –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã —Å –ø–ª–æ—Ö–∏–º ack **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ timestamp –∏–¥—ë—Ç –ø–µ—Ä–≤–æ–π** –≤ —Å–ø–∏—Å–∫–µ TCP –æ–ø—Ü–∏–π
- –ï—Å–ª–∏ timestamp –Ω–µ –ø–µ—Ä–≤–∞—è ‚Äî –ø–∞–∫–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å **–ø—Ä–∏–Ω—è—Ç** –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–ª–æ—Ö–æ–π ack!

`tcp_ts_up` –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç timestamp –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞ –æ–ø—Ü–∏–π ‚Üí Linux –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç.

---

## ‚úÖ **–ö–æ–≥–¥–∞ `tcp_ts_up` –ù–ï –Ω—É–∂–µ–Ω**

1. **–¶–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä ‚Äî –Ω–µ Linux** (Windows, BSD –∏ –¥—Ä.)
2. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `tcp_seq`** (badseq) ‚Äî —Ç–æ–≥–¥–∞ –ø–∞–∫–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ –¥—Ä—É–≥–æ–π –ø—Ä–∏—á–∏–Ω–µ
3. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `tcp_md5`** ‚Äî md5sig —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
4. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `ip_ttl`** ‚Äî –ø–∞–∫–µ—Ç –Ω–µ –¥–æ–π–¥—ë—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
5. **–í –ø–∞–∫–µ—Ç–µ –Ω–µ—Ç timestamp –æ–ø—Ü–∏–∏** ‚Äî –Ω–µ—á–µ–≥–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å

---

## üìä **–¢–∞–±–ª–∏—Ü–∞: –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω `tcp_ts_up`**

| Fooling | Linux | Windows/BSD | `tcp_ts_up` –Ω—É–∂–µ–Ω? |
|---------|-------|-------------|-------------------|
| `tcp_ack` —Ç–æ–ª—å–∫–æ | ‚ö†Ô∏è –ú–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | **–î–∞** (–¥–ª—è Linux) |
| `tcp_seq` —Ç–æ–ª—å–∫–æ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ—Ç |
| `tcp_ack` + `tcp_seq` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ—Ç |
| `tcp_md5` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ—Ç |
| `ip_ttl` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ—Ç |

---

## üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**

**–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã ‚Äî –¥–æ–±–∞–≤–ª—è–π—Ç–µ `tcp_ts_up`**. –û–Ω –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ Linux:

```bash
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ)
--lua-desync=fake:blob=fake_default_tls:tcp_ack=-66000:tcp_ts_up

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ md5sig ‚Äî –ø—Ä–æ—â–µ –∏ –Ω–∞–¥—ë–∂–Ω–µ–µ
--lua-desync=fake:blob=fake_default_tls:tcp_md5
```

---

## üéØ **–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç**

**–ù–µ—Ç, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**, –Ω–æ:
- –ù–∞ **Linux** –±–µ–∑ `tcp_ts_up` badack –º–æ–∂–µ—Ç **–Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å**
- –ù–∞ **Windows/BSD** —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –Ω–µ–≥–æ
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –¥–æ–±–∞–≤–ª—è—Ç—å –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏


## `autottl` ‚Äî —Ñ–æ—Ä–º–∞—Ç **–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**, –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ—Ç!

---

## ‚ùå **–ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ —Ü–∏—Ñ—Ä**

```bash
# –û–®–ò–ë–ö–ê! –¢–∞–∫ –Ω–µ–ª—å–∑—è:
--lua-desync=fake:blob=fake_default_tls:ip_autottl

# –û–®–ò–ë–ö–ê! –¢–∞–∫ —Ç–æ–∂–µ –Ω–µ–ª—å–∑—è:
--lua-desync=fake:blob=fake_default_tls:ip_autottl=
```

–ë—É–¥–µ—Ç –æ—à–∏–±–∫–∞:
```
parse_autottl: invalid value '...'
```

---

## ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç**

```
ip_autottl=delta,min-max
ip6_autottl=delta,min-max
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `delta` | –°–¥–≤–∏–≥ –æ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ hop count (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º) |
| `min` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ TTL |
| `max` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ TTL |

---

## üí° **–ü—Ä–∏–º–µ—Ä—ã**

```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: delta=-1, –¥–∏–∞–ø–∞–∑–æ–Ω 3-20
:ip_autottl=-1,3-20:ip6_autottl=-1,3-20

# –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π: delta=-2
:ip_autottl=-2,3-20:ip6_autottl=-2,3-20

# –û—Å—Ç–æ—Ä–æ–∂–Ω—ã–π: delta=0 (—Ç–æ—á–Ω–æ –¥–æ DPI)
:ip_autottl=0,3-20:ip6_autottl=0,3-20
```

---

## üî¨ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç autottl**

1. **–ü–æ–ª—É—á–∞–µ—Ç incoming TTL** –∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ (SYN-ACK)
2. **–£–≥–∞–¥—ã–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π TTL** —Å–µ—Ä–≤–µ—Ä–∞ (64, 128 –∏–ª–∏ 255)
3. **–í—ã—á–∏—Å–ª—è–µ—Ç hop count** = –Ω–∞—á–∞–ª—å–Ω—ã–π TTL - incoming TTL
4. **–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º—É–ª—É**: fake_ttl = hop_count + delta
5. **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç** —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º min-max

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞:
```
Incoming TTL = 52
–£–≥–∞–¥–∞–Ω–Ω—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π TTL = 64
Hop count = 64 - 52 = 12
delta = -1
–†–µ–∑—É–ª—å—Ç–∞—Ç = 12 + (-1) = 11

–ï—Å–ª–∏ min=3, max=20: –∏—Ç–æ–≥–æ–≤—ã–π TTL = 11 ‚úì
```

---

## ‚ö†Ô∏è **–í–∞–∂–Ω–æ**

- **–¢—Ä–µ–±—É–µ—Ç conntrack** ‚Äî –Ω—É–∂–Ω–æ –≤–∏–¥–µ—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è TTL
- **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** –µ—Å–ª–∏ incoming TTL –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω—ã (32-64, 96-128, 223-255)
- **Fallback –Ω–∞ ip_ttl** ‚Äî –µ—Å–ª–∏ autottl –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ip_ttl` –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω

```bash
# –° fallback –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π TTL:
:ip_ttl=5:ip_autottl=-1,3-20
```

---

## üìù **–¢–∏–ø–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**

```bash
# –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å autottl –∏ fallback
--lua-desync=fake:blob=fake_default_tls:tcp_md5:ip_ttl=5:ip_autottl=-1,3-20:ip6_ttl=5:ip6_autottl=-1,3-20
```

