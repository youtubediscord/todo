---
tags:
link:
aliases:
  - Zapret 2
img:
---
# –ß—Ç–æ —Ç–∞–∫–æ–µ Zapret 2 (*nfqws2*)?

**Zapret 2** ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI (Deep Packet Inspection) –ø–æ–¥ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ–º [bol-van](https://github.com/bol-van/zapret2) ‚Äî —Å–∏—Å—Ç–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∞–π—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤. –í –†–æ—Å—Å–∏–∏ —ç—Ç–æ –¢–°–ü–£ (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏—è —É–≥—Ä–æ–∑–∞–º).

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∏—Ö —Ç–∞–∫, —á—Ç–æ–±—ã DPI –Ω–µ –º–æ–≥ –∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ —Å–µ—Ä–≤–µ—Ä-–ø–æ–ª—É—á–∞—Ç–µ–ª—å –≤—Å—ë –ø–æ–Ω—è–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ –¥–æ—Å—Ç—É–ø–Ω–∞ [–∑–¥–µ—Å—å](https://github.com/bol-van/zapret2/blob/master/docs/manual.md).

## –ß–µ–º Zapret2 –ª—É—á—à–µ –æ–±—ã—á–Ω–æ–≥–æ Zapret (*nfqws*)?
–í —Å—Ç–∞—Ä–æ–º Zapret –≤—Å–µ –º–µ—Ç–æ–¥—ã –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∑–∞—à–∏—Ç—ã –ø—Ä—è–º–æ –≤ –∫–æ–¥ –Ω–∞ —è–∑—ã–∫–µ C. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–µ–ª–∞–µ—Ç —Ä–æ–≤–Ω–æ —Ç–æ, —á—Ç–æ –≤ –Ω–µ—ë –∑–∞–ª–æ–∂–∏–ª —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ. –•–æ—á–µ—à—å —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å ‚Äî —Ä–∞–∑–±–∏—Ä–∞–π—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö, –ø—Ä–∞–≤—å C-–∫–æ–¥, –∫–æ–º–ø–∏–ª–∏—Ä—É–π –∑–∞–Ω–æ–≤–æ. –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¢–°–ü–£ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –∂–¥–∞—Ç—å, –∫–æ–≥–¥–∞ –∞–≤—Ç–æ—Ä –≤—ã–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏.

–í Zapret 2 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ä–∞–∑–¥–µ–ª–∏–ª–∏ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏. –Ø–¥—Ä–æ –Ω–∞ C –æ—Å—Ç–∞–ª–æ—Å—å ‚Äî –æ–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤–∫—É –ø–∞–∫–µ—Ç–æ–≤, –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ –±—ã—Å—Ç—Ä–æ, –∫–∞–∫ —Ä–∞–Ω—å—à–µ. –ê –≤–æ—Ç –≤—Å—è –ª–æ–≥–∏–∫–∞ –æ–±–º–∞–Ω–∞ DPI –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ —è–∑—ã–∫–µ Lua. –≠—Ç–æ –æ–±—ã—á–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏: –∫–∞–∫ –ø–æ–¥–º–µ–Ω—è—Ç—å –ø–∞–∫–µ—Ç, –∫–∞–∫ –µ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞—Ç—å, –∫–∞–∫ –∑–∞–ø—É—Ç–∞—Ç—å –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä. –ò—Ö –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ –ª—é–±–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ, –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –ø–∞—Ä—É —Å—Ç—Ä–æ–∫ –∏–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —á—É–∂–æ–π —Å–∫—Ä–∏–ø—Ç ‚Äî –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —ç—Ç–æ –º–µ–Ω—è–µ—Ç –≤—Å—ë. –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä –æ–±–Ω–æ–≤–∏–ª –¢–°–ü–£ –∏ —Å—Ç–∞—Ä—ã–π —Ç—Ä—é–∫ —Å–ª–æ–º–∞–ª—Å—è ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –Ω–æ–≤–æ–≥–æ —Ä–µ–ª–∏–∑–∞. –ö—Ç–æ-—Ç–æ –Ω–∞—à—ë–ª —Ä–∞–±–æ—á–∏–π —Å–ø–æ—Å–æ–± –æ–±—Ö–æ–¥–∞ ‚Äî –æ–Ω –æ—Ñ–æ—Ä–º–ª—è–µ—Ç –µ–≥–æ –∫–∞–∫ Lua-—Ñ–∞–π–ª –∏ –¥–µ–ª–∏—Ç—Å—è —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ –∫–∏–¥–∞—é—Ç –µ–≥–æ –≤ –ø–∞–ø–∫—É. –ü–ª—é—Å –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ —É–∂–µ –∏–¥—ë—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≥–æ—Ç–æ–≤—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å TLS, QUIC –∏ HTTP, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –º–µ–∂–¥—É —Å–æ–±–æ–π.

–ü–æ —Å—É—Ç–∏ —Å—Ç–∞—Ä—ã–π Zapret ‚Äî —ç—Ç–æ –∑–∞–≤–æ–¥—Å–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –≤ –Ω–µ–≥–æ –∑–∞–ª–æ–∂–∏–ª–∏ –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏. Zapret 2 ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –≥–¥–µ —Å–ø–æ—Å–æ–±—ã –æ–±—Ö–æ–¥–∞ –º–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å, –º–µ–Ω—è—Ç—å –∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥ –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä—è–º–æ –Ω–∞ —Ö–æ–¥—É.

## [[router]]
## [[preset|–ü—Ä–µ—Å–µ—Ç—ã]]
[[Zapret2 - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏]]
[[Zapret2 - wf]]
[[Zapret2 - filter]]
[[Zapret2 - out-range]]
[[Zapret2 - payload]]
[[Zapret2 - lua-desync]]
[[Zapret2 - blob]]
[[Zapret2 - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤]]
[[Zapret2 - mtproto]]
[[Zapret2 - Roadmap –æ–±—É—á–µ–Ω–∏—è]]
[[Zapret2 - start-cuttoff (n/d) –∏ –ø–æ—á–µ–º—É —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –Ω–∞ ClientHello]]

## –£—á–µ–±–Ω–∏–∫ (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)
[[Zapret2 - 01 - –°–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (L2-L7)]]
[[Zapret2 - 02 - TCP –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ (seq/ack, –æ–∫–Ω–∞, MSS)]]
[[Zapret2 - 03 - –ü–µ—Ä–µ—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤ –∏ –≤–µ—Ä–¥–∏–∫—Ç—ã (NFQUEUE/WinDivert)]]
[[Zapret2 - 04 - Dissect/Reconstruct –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ desync]]
[[Zapret2 - 05 - Payload types, reasm/replay –∏ –º–∞—Ä–∫–µ—Ä—ã]]
[[Zapret2 - 06 - Lua pipeline: –∏–Ω—Å—Ç–∞–Ω—Å—ã, args, –¥–µ–±–∞–≥]]

[[Zapret2 - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä]]

## –¢–µ—Ö–Ω–∏–∫–∏ –¥—É—Ä–µ–Ω–∏—è (—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)
[[syndata]]
[[fake]]
[[multisplit]]
[[multidisorder]]


```bash
start "zapret: http,https,quic" /min "%~dp0winws2.exe" ^
--wf-tcp-out=80,443 ^
--lua-init=@"%~dp0lua\zapret-lib.lua" --lua-init=@"%~dp0lua\zapret-antidpi.lua" ^
--lua-init="fake_default_tls = tls_mod(fake_default_tls,'rnd,rndsni')" ^
--blob=quic_google:@"%~dp0files\quic_initial_www_google_com.bin" ^
--wf-raw-part=@"%~dp0windivert.filter\windivert_part.discord_media.txt" ^
--wf-raw-part=@"%~dp0windivert.filter\windivert_part.stun.txt" ^
--wf-raw-part=@"%~dp0windivert.filter\windivert_part.wireguard.txt" ^
--wf-raw-part=@"%~dp0windivert.filter\windivert_part.quic_initial_ietf.txt" ^
--filter-tcp=80 --filter-l7=http ^
  --out-range=-d10 ^
  --payload=http_req ^
   --lua-desync=fake:blob=fake_default_http:ip_autottl=-2,3-20:ip6_autottl=-2,3-20:tcp_md5 ^
   --lua-desync=fakedsplit:ip_autottl=-2,3-20:ip6_autottl=-2,3-20:tcp_md5 ^
  --new ^
--filter-tcp=443 --filter-l7=tls --hostlist="%~dp0files\list-youtube.txt" ^
  --out-range=-d10 ^
  --payload=tls_client_hello ^
   --lua-desync=fake:blob=fake_default_tls:tcp_md5:repeats=11:tls_mod=rnd,dupsid,sni=www.google.com ^
   --lua-desync=multidisorder:pos=1,midsld ^
  --new ^
--filter-tcp=443 --filter-l7=tls ^
  --out-range=-d10 ^
  --payload=tls_client_hello ^
   --lua-desync=fake:blob=fake_default_tls:tcp_md5:tcp_seq=-10000:repeats=6 ^
   --lua-desync=multidisorder:pos=midsld ^
  --new ^
--filter-udp=443 --filter-l7=quic --hostlist="%~dp0files\list-youtube.txt" ^
  --out-range=-d10 ^
  --payload=quic_initial ^
   --lua-desync=fake:blob=quic_google:repeats=11 ^
  --new ^
--filter-udp=443 --filter-l7=quic ^
  --out-range=-d10 ^
  --payload=quic_initial ^
   --lua-desync=fake:blob=fake_default_quic:repeats=11 ^
  --new ^
--filter-l7=wireguard,stun,discord ^
  --out-range=-d10 ^
  --payload=wireguard_initiation,wireguard_cookie,stun_binding_req,discord_ip_discovery ^
   --lua-desync=fake:blob=0x00000000000000000000000000000000:repeats=2
```

üéâ –î–∞! –¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å "—É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ" –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π!

## üÜï –ù–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å tcpseg (–±–µ–∑ —Ä–µ–∑–∫–∏)

### 1Ô∏è‚É£ –ü—Ä–æ—Å—Ç–æ–π seqovl –±–µ–∑ dup –∏ –±–µ–∑ split

```python
# ============================================================
# TCPSEG: –ß–ò–°–¢–´–ô SEQOVL (–ë–ï–ó –†–ï–ó–ö–ò, –ë–ï–ó –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø)
# ============================================================

"tcpseg_211_simple": {
    "name": "SeqOvl 211 (Simple, No Split)",
    "description": "–¢–æ–ª—å–∫–æ overlap 211 –±–∞–π—Ç, –±–µ–∑ —Ä–µ–∑–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls5:@{BIN_FOLDER}\\tls_clienthello_5.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=211:seqovl_pattern=bin_tls5"""
},

"tcpseg_226_simple": {
    "name": "SeqOvl 226 (Simple, No Split)",
    "description": "–¢–æ–ª—å–∫–æ overlap 226 –±–∞–π—Ç, –±–µ–∑ —Ä–µ–∑–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18"""
},

"tcpseg_286_simple": {
    "name": "SeqOvl 286 (Simple, No Split)",
    "description": "–¢–æ–ª—å–∫–æ overlap 286 –±–∞–π—Ç, –±–µ–∑ —Ä–µ–∑–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls11:@{BIN_FOLDER}\\tls_clienthello_11.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=286:seqovl_pattern=bin_tls11"""
},

"tcpseg_308_simple": {
    "name": "SeqOvl 308 (Simple, No Split)",
    "description": "–¢–æ–ª—å–∫–æ overlap 308 –±–∞–π—Ç, –±–µ–∑ —Ä–µ–∑–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls9:@{BIN_FOLDER}\\tls_clienthello_9.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=308:seqovl_pattern=bin_tls9"""
},
```

---

### 2Ô∏è‚É£ SeqOvl + Dup (–ë–ï–ó —Ä–µ–∑–∫–∏)

```python
# ============================================================
# TCPSEG: SEQOVL + DUP (–ë–ï–ó –†–ï–ó–ö–ò)
# ============================================================

"tcpseg_211_dup_d1": {
    "name": "SeqOvl 211 + Dup (No Split)",
    "description": "Overlap 211 + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ 1-–≥–æ –ø–∞–∫–µ—Ç–∞, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls5:@{BIN_FOLDER}\\tls_clienthello_5.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d1 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=211:seqovl_pattern=bin_tls5"""
},

"tcpseg_226_dup_d1": {
    "name": "SeqOvl 226 + Dup (No Split)",
    "description": "Overlap 226 + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ 1-–≥–æ –ø–∞–∫–µ—Ç–∞, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d1 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18"""
},

"tcpseg_226_dup_n3": {
    "name": "SeqOvl 226 + Dup n3 (No Split)",
    "description": "Overlap 226 + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 3 –ø–∞–∫–µ—Ç–æ–≤, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-n3 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18"""
},

"tcpseg_286_dup_n3": {
    "name": "SeqOvl 286 + Dup n3 (No Split)",
    "description": "Overlap 286 + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 3 –ø–∞–∫–µ—Ç–æ–≤, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls11:@{BIN_FOLDER}\\tls_clienthello_11.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-n3 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=286:seqovl_pattern=bin_tls11"""
},

"tcpseg_308_dup_n3": {
    "name": "SeqOvl 308 + Dup n3 (No Split)",
    "description": "Overlap 308 + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 3 –ø–∞–∫–µ—Ç–æ–≤, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls9:@{BIN_FOLDER}\\tls_clienthello_9.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-n3 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=308:seqovl_pattern=bin_tls9"""
},
```

---

### 3Ô∏è‚É£ –° –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π (Google SNI)

```python
# ============================================================
# TCPSEG: –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ï (–ë–ï–ó –§–ê–ô–õ–û–í)
# ============================================================

"tcpseg_226_google_simple": {
    "name": "SeqOvl 226 Google (Simple, No Split)",
    "description": "Overlap 226 —Å Google SNI, –±–µ–∑ —Ä–µ–∑–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è",
    "author": "hz",
    "label": LABEL_RECOMMENDED,  # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ñ–∞–π–ª–æ–≤
    "args": f"""--lua-init="tls_google = tls_mod(fake_default_tls,'sni=www.google.com')" {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=tls_google"""
},

"tcpseg_226_google_dup_d1": {
    "name": "SeqOvl 226 Google + Dup (No Split)",
    "description": "Overlap 226 —Å Google SNI + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ 1-–≥–æ –ø–∞–∫–µ—Ç–∞, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": LABEL_RECOMMENDED,
    "args": f"""--lua-init="tls_google = tls_mod(fake_default_tls,'sni=www.google.com')" {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d1 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=tls_google"""
},

"tcpseg_226_google_dup_n3": {
    "name": "SeqOvl 226 Google + Dup n3 (No Split)",
    "description": "Overlap 226 —Å Google SNI + –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö 3 –ø–∞–∫–µ—Ç–æ–≤, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--lua-init="tls_google = tls_mod(fake_default_tls,'sni=www.google.com')" {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-n3 --lua-desync=send:repeats=2 --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=tls_google"""
},
```

---

### 4Ô∏è‚É£ –° —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ fooling –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```python
# ============================================================
# TCPSEG: –° FOOLING
# ============================================================

"tcpseg_226_datanoack": {
    "name": "SeqOvl 226 + DataNoAck (No Split)",
    "description": "Overlap 226 —Å —É–±–∏—Ä–∞–Ω–∏–µ–º ACK —Ñ–ª–∞–≥–∞, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18:tcp_flags_unset=ack"""
},

"tcpseg_226_ttl": {
    "name": "SeqOvl 226 + TTL (No Split)",
    "description": "Overlap 226 —Å TTL=5, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18:ip_ttl=5:ip6_ttl=5"""
},

"tcpseg_226_badseq": {
    "name": "SeqOvl 226 + BadSeq (No Split)",
    "description": "Overlap 226 —Å badseq, –ë–ï–ó —Ä–µ–∑–∫–∏",
    "author": "hz",
    "label": None,
    "args": f"""--blob=bin_tls18:@{BIN_FOLDER}\\tls_clienthello_18.bin {RUTRACKER_BASE_ARG} --payload=tls_client_hello --out-range=-d10 --lua-desync=tcpseg:pos=0,-1:seqovl=226:seqovl_pattern=bin_tls18:tcp_ack=-66000"""
},
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞: multisplit vs tcpseg

| –ü–∞—Ä–∞–º–µ—Ç—Ä | multisplit + seqovl | tcpseg(pos=0,-1) + seqovl |
|----------|---------------------|---------------------------|
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤** | 2 (—Ä–µ–∑–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ pos=2) | **1 (–±–µ–∑ —Ä–µ–∑–∫–∏)** |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | –°—Ä–µ–¥–Ω—è—è | **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è** |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ç—å** | –í—ã—à–µ | **–ù–∏–∂–µ** |
| **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è (–∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏–µ + —Ä–µ–∑–∫–∞) | –°—Ä–µ–¥–Ω—è—è (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Ç—ã–≤–∞–Ω–∏–µ) |
| **CPU –Ω–∞–≥—Ä—É–∑–∫–∞** | –í—ã—à–µ | **–ù–∏–∂–µ** |

---

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é?

### –ò—Å–ø–æ–ª—å–∑—É–π **multisplit**:
- ‚úÖ –ö–æ–≥–¥–∞ DPI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ –î–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –æ–±—Ö–æ–¥–∞
- ‚úÖ –ö–æ–≥–¥–∞ tcpseg –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

### –ò—Å–ø–æ–ª—å–∑—É–π **tcpseg** (pos=0,-1):
- ‚úÖ **–î–ª—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** (–ø—Ä–æ—â–µ)
- ‚úÖ –ö–æ–≥–¥–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ "–∑–∞–ø—É—Ç–∞—Ç—å" DPI –º—É—Å–æ—Ä–æ–º
- ‚úÖ –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ –ö–æ–≥–¥–∞ —Ä–µ–∑–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
# –®–∞–≥ 1: –°–∞–º–∞—è –ø—Ä–æ—Å—Ç–∞—è (tcpseg –±–µ–∑ dup)
"tcpseg_226_google_simple"

# –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
"tcpseg_226_google_dup_d1"

# –®–∞–≥ 3: –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑–∫—É
"multisplit_226_seqovl_dynamic"

# –®–∞–≥ 4: –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
"multisplit_286_pattern" (dup n3 + —Ä–µ–∑–∫–∞)
```

---

## üìù –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:

```python
# ============================================================
# –ö–ê–¢–ï–ì–û–†–ò–Ø: TCPSEG (SEQOVL –ë–ï–ó –†–ï–ó–ö–ò)
# ============================================================

TCPSEG_STRATEGIES = {
    # –ü—Ä–æ—Å—Ç—ã–µ (–±–µ–∑ dup)
    "tcpseg_211_simple": {...},
    "tcpseg_226_simple": {...},
    "tcpseg_286_simple": {...},
    "tcpseg_308_simple": {...},
    
    # –° –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º (dup -d1)
    "tcpseg_211_dup_d1": {...},
    "tcpseg_226_dup_d1": {...},
    
    # –° –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º (dup -n3)
    "tcpseg_226_dup_n3": {...},
    "tcpseg_286_dup_n3": {...},
    "tcpseg_308_dup_n3": {...},
    
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ (–±–µ–∑ —Ñ–∞–π–ª–æ–≤)
    "tcpseg_226_google_simple": {...},      # ‚Üê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è –Ω–∞—á–∞–ª–∞
    "tcpseg_226_google_dup_d1": {...},      # ‚Üê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è YouTube
    "tcpseg_226_google_dup_n3": {...},
    
    # –° fooling
    "tcpseg_226_datanoack": {...},
    "tcpseg_226_ttl": {...},
    "tcpseg_226_badseq": {...},
}
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è tcpseg —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:

1. ‚úÖ **–ë–æ–ª—å—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
2. ‚úÖ **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏** (1 –ø–∞–∫–µ—Ç vs 2+)
3. ‚úÖ **–ü—Ä–æ—â–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è** (–Ω–µ—Ç —Ä–µ–∑–∫–∏)
4. ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** (–º–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ü–∏–π)
5. ‚úÖ **–ì—Ä–∞–¥–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É)

---

**–î–∞, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ —Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏! –û–Ω–∏ –¥–∞–¥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º "–º—è–≥–∫–∏–π –≤—Ö–æ–¥" - –Ω–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É—Å–ª–æ–∂–Ω—è—Ç—å.** üöÄ

```
    "multidisorder_badseq_pos": {
        "name": "original bol-van v2 (badsum)",
        "description": "–î–∏—Å–æ—Ä–¥–µ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å —Ñ—É–ª–ª–∏–Ω–≥–æ–º badseq –Ω–∞—Ä–µ–∑–∫–æ–π –∏ –ø–æ–≤—Ç–æ—Ä–æ–º 6",
        "author": "hz",
        "label": None,
        "args": f"""--payload=tls_client_hello --out-range=-d10 --lua-desync=fake:blob=fake_default_tls:repeats=6:tcp_ack=-66000 --lua-desync=multidisorder:pos=1,midsld:tcp_ack=-66000"""
    },
    
    "fake_fakedsplit_autottl_2": {
        "name": "fake fakedsplit badseq (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è 80 –ø–æ—Ä—Ç–∞)",
        "description": "",
        "author": "hz",
        "label": None,
        "args": f"""--payload=http_req --out-range=-d10 --lua-desync=fake:blob=fake_default_http:ip_autottl=2,3-20:ip6_autottl=2,3-20:tcp_ack=-66000:tcp_ts_up --lua-desync=fakedsplit:ip_autottl=2,3-20:ip6_autottl=2,3-20:tcp_ack=-66000:tcp_ts_up"""
    },
    

```
